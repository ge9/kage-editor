(this["webpackJsonpkage-editor"]=this["webpackJsonpkage-editor"]||[]).push([[0],{45:function(e){e.exports=JSON.parse('{"stroke type":"\u7dda\u7a2e","stroke type 1":"\u76f4\u7dda","stroke type 2":"\u66f2\u7dda","stroke type 3":"\u6298\u308c","stroke type 4":"\u4e59\u7dda","stroke type 6":"\u8907\u66f2\u7dda","stroke type 7":"\u7e26\u6255\u3044","head type":"\u982d\u5f62\u72b6","head type 1-0":"\u958b\u653e","head type 1-2":"\u63a5\u7d9a(\u6a2a)","head type 1-32":"\u63a5\u7d9a(\u7e26)","head type 1-12":"\u5de6\u4e0a\u30ab\u30c9","head type 1-22":"\u53f3\u4e0a\u30ab\u30c9","head type 2-0":"\u958b\u653e","head type 2-32":"\u63a5\u7d9a","head type 2-12":"\u5de6\u4e0a\u30ab\u30c9","head type 2-22":"\u53f3\u4e0a\u30ab\u30c9","head type 2-7":"\u7d30\u5165\u308a","head type 2-27":"\u5c4b\u6839\u4ed8\u304d\u7d30\u5165\u308a","head type 3-0":"\u958b\u653e","head type 3-32":"\u63a5\u7d9a(\u7e26)","head type 3-12":"\u5de6\u4e0a\u30ab\u30c9","head type 3-22":"\u53f3\u4e0a\u30ab\u30c9","head type 4-0":"\u958b\u653e","head type 4-22":"\u53f3\u4e0a\u30ab\u30c9","head type 6-0":"\u958b\u653e","head type 6-32":"\u63a5\u7d9a","head type 6-12":"\u5de6\u4e0a\u30ab\u30c9","head type 6-22":"\u53f3\u4e0a\u30ab\u30c9","head type 6-7":"\u7d30\u5165\u308a","head type 6-27":"\u5c4b\u6839\u4ed8\u304d\u7d30\u5165\u308a","head type 7-0":"\u958b\u653e","head type 7-32":"\u63a5\u7d9a","head type 7-12":"\u5de6\u4e0a\u30ab\u30c9","head type 7-22":"\u53f3\u4e0a\u30ab\u30c9","tail type":"\u5c3e\u5f62\u72b6","tail type 1-0":"\u958b\u653e","tail type 1-2":"\u63a5\u7d9a(\u6a2a)","tail type 1-32":"\u63a5\u7d9a(\u7e26)","tail type 1-13":"\u5de6\u4e0b\u30ab\u30c9","tail type 1-23":"\u53f3\u4e0b\u30ab\u30c9","tail type 1-4":"\u5de6\u30cf\u30cd","tail type 1-313":"\u5de6\u4e0bzh\u7528\u65e7","tail type 1-413":"\u5de6\u4e0bzh\u7528\u65b0","tail type 1-24":"\u53f3\u4e0bH/T","tail type 2-7":"\u5de6\u6255\u3044","tail type 2-0":"\u53f3\u6255\u3044","tail type 2-8":"\u6b62\u3081","tail type 2-4":"\u5de6\u30cf\u30cd","tail type 2-5":"\u53f3\u30cf\u30cd","tail type 3-0":"\u958b\u653e","tail type 3-5":"\u4e0a\u30cf\u30cd","tail type 4-0":"\u958b\u653e","tail type 4-5":"\u4e0a\u30cf\u30cd","tail type 6-7":"\u5de6\u6255\u3044","tail type 6-0":"\u53f3\u6255\u3044","tail type 6-8":"\u6b62\u3081","tail type 6-4":"\u5de6\u30cf\u30cd","tail type 6-5":"\u53f3\u30cf\u30cd","tail type 7-7":"\u5de6\u6255\u3044","invalid stroke shape types":"\u30a8\u30e9\u30fc:\u3042\u308a\u3048\u306a\u3044\u7b46\u753b\u30fb\u5f62\u72b6\u306e\u7d44\u307f\u5408\u308f\u305b\u3067\u3059","part":"\u90e8\u54c1","alias of":"({{entity}} \u306e\u30a8\u30a4\u30ea\u30a2\u30b9)","stretch":"\u30b9\u30c8\u30ec\u30c3\u30c1:","selecting multiple strokes":"\u8907\u6570\u9078\u629e\u4e2d","select prev":"\u2190","swap with prev":"\u5165\u66ff\u2190","select next":"\u2192","swap with next":"\u2192\u5165\u66ff","undo":"\u5143\u306b\u623b\u3059","redo":"\u3084\u308a\u76f4\u3059","select all":"\u3059\u3079\u3066\u3092\u9078\u629e","invert selection":"\u9078\u629e\u7bc4\u56f2\u3092\u53cd\u8ee2","copy":"\u30b3\u30d4\u30fc","paste":"\u8cbc\u308a\u4ed8\u3051","cut":"\u5207\u308a\u53d6\u308a","start freehand":"\u624b\u66f8\u304d\u958b\u59cb","end freehand":"\u624b\u66f8\u304d\u7d42\u4e86","decompose":"\u90e8\u54c1\u5206\u89e3","options":"\u8868\u793a\u8a2d\u5b9a...","finish edit":"\u7de8\u96c6\u7d42\u4e86","search":"\u691c\u7d22","searching":"\u691c\u7d22\u4e2d","search error":"\u30a8\u30e9\u30fc:{{message}}","search query too short":"\u30a8\u30e9\u30fc:\u30ad\u30fc\u30ef\u30fc\u30c9\u304c\u77ed\u3059\u304e\u307e\u3059","no search result":"\u8a72\u5f53\u90e8\u54c1\u306a\u3057","grid option":"\u30b0\u30ea\u30c3\u30c9","enable grid":"\u6709\u52b9\u306b\u3059\u308b","grid origin x":"\u958b\u59cbX","grid origin y":"\u958b\u59cbY","grid spacing x":"\u9593\u9694X","grid spacing y":"\u9593\u9694Y","glyph font style":"\u66f8\u4f53","mincho style":"\u660e\u671d","gothic style":"\u30b4\u30b7\u30c3\u30af","show stroke center line":"\u4e2d\u5fc3\u7dda\u3092\u8868\u793a","display language":"\u8868\u793a\u8a00\u8a9e","close modal":"\u9589\u3058\u308b"}')},46:function(e){e.exports=JSON.parse('{"stroke type":"Type","stroke type 1":"straight line","stroke type 2":"curve","stroke type 3":"bend line","stroke type 4":"OTSU curve","stroke type 6":"cmplx. curve","stroke type 7":"vert slash","head type":"Head","head type 1-0":"free","head type 1-2":"connect(h)","head type 1-32":"connect(v)","head type 1-12":"L-top corner.","head type 1-22":"R-top corner","head type 2-0":"free","head type 2-32":"connect","head type 2-12":"L-top corner","head type 2-22":"R-top corner","head type 2-7":"narrow fot dot","head type 2-27":"roofed narrow","head type 3-0":"free","head type 3-32":"connect(v)","head type 3-12":"L-top corner","head type 3-22":"R-top corner","head type 4-0":"free","head type 4-22":"R-top corner","head type 6-0":"free","head type 6-32":"connect","head type 6-12":"L-top corner","head type 6-22":"R-top corner","head type 6-7":"narrow for dot","head type 6-27":"roofed narrow","head type 7-0":"free","head type 7-32":"connect","head type 7-12":"L-top corner","head type 7-22":"R-top corner","tail type":"Tail","tail type 1-0":"free","tail type 1-2":"connect(h)","tail type 1-32":"connect(v)","tail type 1-13":"L-btm. corner","tail type 1-23":"R-btm. corner","tail type 1-4":"slash left","tail type 1-313":"L-btm.(zh:old)","tail type 1-413":"L-btm.(zh:new)","tail type 1-24":"R-tbm.(H/T)","tail type 2-7":"slash left","tail type 2-0":"slash right","tail type 2-8":"stop for dot","tail type 2-4":"hook left","tail type 2-5":"hook right","tail type 3-0":"free","tail type 3-5":"hook up","tail type 4-0":"free","tail type 4-5":"hook up","tail type 6-7":"slash left","tail type 6-0":"slash right","tail type 6-8":"stop for dot","tail type 6-4":"hook left","tail type 6-5":"hook right","tail type 7-7":"slash left","invalid stroke shape types":"Error: illegal combination of shape types","part":"Part","alias of":"(alias of {{entity}})","stretch":"Stretch:","selecting multiple strokes":"Selecting multiple items","select prev":"\u2190","swap with prev":"Swap\u2190","select next":"\u2192","swap with next":"\u2192Swap","undo":"Undo","redo":"Redo","select all":"Select All","invert selection":"Invert Selection","copy":"Copy","paste":"Paste","cut":"Cut","start freehand":"Freedraw","end freehand":"Stop freedraw","decompose":"Decompose","options":"Options...","finish edit":"Finish editing","search":"Search","searching":"Searching","search error":"Error: {{message}}","search query too short":"Error: keyword is too short","no search result":"Not found","grid option":"Grid","enable grid":"Enable","grid origin x":"Origin X","grid origin y":"Origin Y","grid spacing x":"Spacing X","grid spacing y":"Spacing Y","glyph font style":"Font","mincho style":"mincho","gothic style":"gothic","show stroke center line":"Draw center line of strokes","display language":"Language","close modal":"Close"}')},49:function(e,t,n){e.exports=n(95)},67:function(e,t,n){},68:function(e,t,n){},69:function(e,t,n){},70:function(e,t,n){},71:function(e,t,n){},72:function(e,t,n){},73:function(e,t,n){},74:function(e,t,n){},80:function(e,t,n){},81:function(e,t,n){},82:function(e,t,n){},92:function(e,t,n){},93:function(e,t,n){},94:function(e,t,n){},95:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(14),l=n.n(c),u=n(3),o=n(20),i=n(21),s=function(e){switch(e){case 0:case 1:case 9:return 7;case 2:case 3:case 4:return 9;case 6:case 7:case 99:return 11;default:return 0}},d=function(e){var t=e.value.map((function(e){return Math.round(e)}));return 99===t[0]&&(t[7]=e.partName||""),t.join(":")},p=function(e){return e.split(/[$\r\n]+/).map((function(e){return function(e){for(var t=e.split(":"),n=+t[0],a=s(n),r=[],c=0;c<a;c++)r.push(Math.floor(+t[c]||0));return 99===r[0]?{value:r,partName:t[7]||""}:{value:r}}(e)})).filter((function(e){return 0!==(t=e).value.length&&(0!==t.value[0]||97===t.value[1]||98===t.value[1]||99===t.value[1]);var t}))},h=function(e){return e.map((function(e){return d(e)})).join("$")},v=new URLSearchParams(window.location.hash.slice(1)),f=v.get("host"),b="false"!==v.get("ssl"),m=v.get("name"),g=v.get("related")||"u3013",y=v.get("edittime"),O=v.get("data")||"",j=v.get("summary")||"",E=["glyphwiki.org","en.glyphwiki.org","ko.glyphwiki.org","zhs.glyphwiki.org","zht.glyphwiki.org"];if(!f&&document.referrer)try{var k=new URL(document.referrer);E.includes(k.host)&&(f=k.host,b="https:"===k.protocol)}catch(Ft){}f&&E.includes(f)||(f="glyphwiki.org");var S,M={host:f,ssl:b,name:m,related:g,edittime:y,data:O,summary:j},C=n(9),w=n(1),T=n(6),x=n.n(T),N=x()("SELECT"),I={selectSingle:N("SELECT_SINGLE"),selectAddSingle:N("SELECT_ADD_SINGLE"),selectRemoveSingle:N("SELECT_REMOVE_SINGLE"),selectNone:N("SELECT_NONE"),selectAll:N("SELECT_ALL"),selectDeselected:N("SELECT_TOGGLE_ALL"),selectPrev:N("SELECT_PREV"),selectNext:N("SELECT_NEXT")},D=n(2),_=n(24);!function(e){e[e.north=0]="north",e[e.south=1]="south",e[e.east=2]="east",e[e.west=3]="west",e[e.southeast=4]="southeast"}(S||(S={}));var P,R,L=x()("EDITOR"),A={startBackgroundDrag:L("BACKGROUND_DRAG_START"),startSelectionDrag:L("SELECTION_DRAG_START"),startPointDrag:L("MOVE_POINT_START"),startResize:L("RESIZE_START"),mouseMove:L("MOUSE_MOVE"),mouseUp:L("MOUSE_UP"),updateCTMInv:L("UPDATE_CTMINV")},G=n(8),Y=n(7),X=[[{position:"start",strokeTypes:[1],shapeTypes:[2]},{position:"start",strokeTypes:[1,2,3,4,6,7],shapeTypes:[12]}],[{position:"start",strokeTypes:[1],shapeTypes:[2]},{position:"end",strokeTypes:[1],shapeTypes:[13,313,413]}],[{position:"end",strokeTypes:[1],shapeTypes:[2]},{position:"start",strokeTypes:[1,2,3,4,6,7],shapeTypes:[22,27]}],[{position:"end",strokeTypes:[1],shapeTypes:[2]},{position:"end",strokeTypes:[1],shapeTypes:[23,24]}]],H=function(e,t){return e.position===t.position&&e.strokeTypes.includes(t.strokeType)&&e.shapeTypes.includes(t.shapeType)},z=function(e){var t=[];switch(e.value[0]){case 1:case 2:case 3:case 4:case 6:case 7:t.push({position:"start",strokeType:e.value[0],shapeType:e.value[1],coord:[e.value[3],e.value[4]],pointIndex:0});var n=(s(e.value[0])-3)/2-1;t.push({position:"end",strokeType:e.value[0],shapeType:e.value[2],coord:[e.value[3+2*n],e.value[3+2*n+1]],pointIndex:n})}return t},U=Object(Y.a)((function(e,t){var n,a=[],r=Object(G.a)(t);try{for(r.s();!(n=r.n()).done;){var c,l=n.value,u=l.lineIndex,o=l.pointIndex,i=Object(G.a)(z(e[u]));try{for(i.s();!(c=i.n()).done;){var s=c.value;s.pointIndex===o&&a.push(s)}}catch(p){i.e(p)}finally{i.f()}}}catch(p){r.e(p)}finally{r.f()}var d=[];return e.forEach((function(e,t){var n,r=Object(G.a)(z(e));try{var c=function(){var e=n.value;a.some((function(t){return a=e,(n=t).coord[0]===a.coord[0]&&n.coord[1]===a.coord[1]&&X.some((function(e){var t=Object(D.a)(e,2),r=t[0],c=t[1];return H(r,n)&&H(c,a)||H(c,n)&&H(r,a)}));var n,a}))&&d.push({lineIndex:t,pointIndex:e.pointIndex})};for(r.s();!(n=r.n()).done;)c()}catch(p){r.e(p)}finally{r.f()}})),d}),(function(e,t){var n=Object(D.a)(e,2),a=n[0],r=n[1],c=Object(D.a)(t,2),l=c[0],u=c[1];return a===l&&r.length===u.length&&r.every((function(e,t){return e.lineIndex===u[t].lineIndex&&e.pointIndex===u[t].pointIndex}))})),F=Object(Y.a)((function(e,t){var n,a=[],r=Object(G.a)(t);try{for(r.s();!(n=r.n()).done;){var c=n.value,l=e[c];a.push({lineIndex:c,pointIndex:0}),a.push({lineIndex:c,pointIndex:(s(l.value[0])-3)/2-1})}}catch(u){r.e(u)}finally{r.f()}return U(e,a).filter((function(e){var n=e.lineIndex;return!t.includes(n)}))})),q=function(e,t,n){switch(e.value[0]){case 99:var a=e.value.slice();return a[3]=t(a[3]),a[4]=n(a[4]),a[5]=t(a[5]),a[6]=n(a[6]),{value:a,partName:e.partName};case 0:case 1:case 2:case 3:case 4:case 6:case 7:case 9:for(var r=e.value.slice(),c=3;c+2<=r.length;c+=2)r[c]=t(r[c]),r[c+1]=n(r[c+1]);return{value:r};default:return e}},B=function(e,t,n,a){if(0===t.length)return e;var r,c=e.slice(),l=Object(G.a)(t);try{for(l.s();!(r=l.n()).done;){var u=r.value,o=u.lineIndex,i=u.pointIndex,s=c[o],d=s.value.slice();d[3+2*i]=n(d[3+2*i]),d[3+2*i+1]=a(d[3+2*i+1]),c[o]=Object(w.a)(Object(w.a)({},s),{},{value:d})}}catch(p){l.e(p)}finally{l.f()}return c},W=function(e,t,n,a){if(0===t.length)return e;var r=F(e,t),c=function(e){return Math.round(e+n)},l=function(e){return Math.round(e+a)};return e=e.map((function(e,n){return t.includes(n)?q(e,c,l):e})),e=B(e,r,c,l)},K=function(e,t,n,a,r){if(0===t.length)return e;var c=t[0],l={lineIndex:c,pointIndex:n},u=U(e,[l]).filter((function(e){return e.lineIndex!==c}));u.push(l);return e=B(e,u,(function(e){return Math.round(e+a)}),(function(e){return Math.round(e+r)}))},V=function(e,t,n,a){return e.map((function(e,r){return t.includes(r)?function(e,t,n){var a=Object(D.a)(t,4),r=a[0],c=a[1],l=a[2],u=a[3],o=Object(D.a)(n,4),i=o[0],s=o[1],d=o[2],p=o[3];return q(e,(function(e){return Math.round(i+(e-r)*(d-i)/(l-r))}),(function(e){return Math.round(s+(e-c)*(p-s)/(u-c))}))}(e,n,a):e}))},$=function(e){return function(e){return e.reduce((function(e,t){return e+t}),0)}(e)/e.length},J=function(e,t,n){return e*(1-n)+t*n},Q=function(e,t){return e*e+t*t},Z=function(e,t){var n=Object(D.a)(t[0],2),a=n[0],r=n[1],c=Object(D.a)(t[t.length-1],2),l=c[0],u=c[1],o=l-a,i=u-r;if(e.length>0&&Q(o,i)<Math.pow(25,2)){var s=e[e.length-1];if([1,2,3,4,6].includes(s.value[0])&&Q(a-s.value[s.value.length-2],r-s.value[s.value.length-1])<Math.pow(10,2)){if([1,2,6].includes(s.value[0])&&o<0){var d={value:s.value.slice()};return d.value[2]=4,27===d.value[1]&&(d.value[1]=22),e.slice(0,-1).concat([d])}if([2,6].includes(s.value[0])&&o>=0&&i<0){var p={value:s.value.slice()};return p.value[2]=5,7===p.value[1]?p.value[1]=0:27===p.value[1]&&(p.value[1]=22),e.slice(0,-1).concat([p])}if([3,4].includes(s.value[0])&&i<0){var h={value:s.value.slice()};return h.value[2]=5,e.slice(0,-1).concat([h])}}}var v=$(t.map((function(e){return Object(D.a)(e,1)[0]}))),f=$(t.map((function(e){var t=Object(D.a)(e,2);t[0];return t[1]}))),b=J((a+l)/2,v,3),m=J((r+u)/2,f,3),g=(o*m-i*b+a*u-r*l)/Math.sqrt(Q(o,i));if(Math.abs(g)<=5&&(o>0&&Math.abs(i)<=.5*o||i>0&&-i<=o&&o<=.5*i))return te(e,{value:[1,0,0,a,r,l,u]});if(o<0&&i>=50&&g<0&&-3*o<i){var y=a,O=J(r,u,1/3),j=a,E=J(r,u,2/3);return te(e,{value:[7,0,7,a,r,y,O,j,E,l,u]})}var k=0,S=7;if(o>0&&i>0&&g>0){var M=function(e,t){var n,a=void 0,r=1/0,c=Object(G.a)(e);try{for(c.s();!(n=c.n()).done;){var l=n.value,u=t(l);u<r&&(a=l,r=u)}}catch(o){c.e(o)}finally{c.f()}return a}(t,(function(e){var t=Object(D.a)(e,2);return t[0]-t[1]})),C=Object(D.a)(M,2),w=C[0],T=C[1],x=a-w,N=r-T,I=l-w,_=u-T,P=(x*I+N*_)/Math.sqrt(Q(x,N)*Q(I,_));if(x<50&&I>30&&-20<=_&&_<=20&&P>-.15){var R=function(e,t){var n,a=1/0,r=Object(G.a)(e);try{for(r.s();!(n=r.n()).done;){var c=n.value,l=t?t(c):c;l<a&&(a=l)}}catch(u){r.e(u)}finally{r.f()}return a}(t,(function(e){return Object(D.a)(e,1)[0]}));return te(e,{value:[3,0,0,a,r,R,u,l,u]})}k=7,S=0}else o>0&&i>0&&g<0&&(k=7,S=8);return te(e,{value:[2,k,S,a,r,b,m,l,u]})},ee=function(e){return Math.round(e)},te=function(e,t){return P=t.value.map((function(){return!1})),e=ce(e,t),e=oe(e,t),ue(t),t=q(t,ee,ee),(e=ie(e,t)).concat([t])},ne=function(e,t,n,a){return e[t].value[n]===a?e:e.map((function(e,r){if(r!==t)return e;var c=Object(w.a)(Object(w.a)({},e),{},{value:e.value.slice()});return c.value[n]=a,c}))},ae=function(e,t,n,a,r,c){for(var l="start"===n?1:2,u="start"===n?3:t.value.length-2,o=u+1,i=t.value[u],s=t.value[o],d=i-10,p=i+10,h=s-10,v=s+10,f=e.length-1;f>=0;f--){var b=e[f];if(1===b.value[0]){var m=b.value[3],g=b.value[4],y=b.value[5],O=b.value[6];if(!(y-m<Math.abs(O-g))){if([0,2].includes(b.value[1])&&d<=m&&m<=p&&h<=g&&g<=v)return t.value[u]=m,t.value[o]=g,P[u]=P[o]=!0,t.value[l]=a,ne(e,f,1,2);if([0,2].includes(b.value[2])&&d<=y&&y<=p&&h<=O&&O<=v)return t.value[u]=y,t.value[o]=O,P[u]=P[o]=!0,t.value[l]=c,ne(e,f,2,2);if(g===O&&h<=g&&g<=v&&m<=i&&i<=y)return t.value[o]=g,P[o]=!0,t.value[l]=r,e}}}return e},re=function(e,t,n){for(var a="start"===n?1:2,r="start"===n?3:5,c=r+1,l=t.value[r],u=t.value[c],o=l-10,i=l+10,s=u-10,d=u+10,p=e.length-1;p>=0;p--){var h=e[p];if([1,2,3,4,6,7].includes(h.value[0])){var v=h.value[3],f=h.value[4],b=h.value[5],m=h.value[6];if(!(1===h.value[0]&&b-v>Math.abs(m-f))){if("start"===n){if([0,12].includes(h.value[1])&&o<=v&&v<=i&&s<=f&&f<=d)return t.value[r]=v,t.value[c]=f,P[r]=P[c]=!0,t.value[a]=2,ne(e,p,1,12);if(1===h.value[0]&&[0,13,313,413].includes(h.value[2])&&o<=b&&b<=i&&s<=m&&m<=d)return t.value[r]=b,t.value[c]=m,P[r]=P[c]=!0,t.value[a]=2,0===h.value[2]?ne(e,p,2,13):e}else{if([0,22].includes(h.value[1])&&o<=v&&v<=i&&s<=f&&f<=d)return t.value[r]=v,t.value[c]=f,P[r]=P[c]=!0,t.value[a]=2,ne(e,p,1,22);if(1===h.value[0]&&[0,23,24].includes(h.value[2])&&o<=b&&b<=i&&s<=m&&m<=d)return t.value[r]=b,t.value[c]=m,P[r]=P[c]=!0,t.value[a]=2,0===h.value[2]?ne(e,p,2,23):e}if(v===b&&o<=v&&v<=i&&f<=u&&u<=m)return t.value[r]=v,P[r]=!0,t.value[a]=2,e}}}return e},ce=function(e,t){if(1!==t.value[0]){if(t.value[4]>t.value[6])return e;var n=7===t.value[1]?7:32,a=7===t.value[1]?27:22;return ae(e,t,"start",12,n,a)}var r=t.value[3],c=t.value[4],l=t.value[5],u=t.value[6];return l-r>Math.abs(u-c)?re(e,t,"start"):u-c>0?ae(e,t,"start",12,32,22):e},le=function(e,t){var n=3+2*t,a=n+1,r=n+2,c=n+3,l=e.value[n],u=e.value[a],o=e.value[r],i=e.value[c],s=o-l,d=i-u;if(Math.abs(s)>20*Math.abs(d)){if(!P[c])return void(e.value[c]=u);if(!P[a])return void(e.value[a]=i)}if(Math.abs(d)>20*Math.abs(s)){if(!P[r])return void(e.value[r]=l);if(!P[n])return void(e.value[n]=o)}},ue=function(e){switch(e.value[0]){case 1:return void le(e,0);case 3:return le(e,0),void le(e,1);case 4:return void le(e,1);case 7:e.value[5]=e.value[7]=e.value[3]}},oe=function(e,t){if(1!==t.value[0])return e;var n=t.value[3],a=t.value[4],r=t.value[5],c=t.value[6];return r-n>Math.abs(c-a)?re(e,t,"end"):c-a>0?ae(e,t,"end",13,32,23):e},ie=function(e,t){if(1!==t.value[0])return e;var n=t.value[3],a=t.value[4],r=t.value[5],c=t.value[6];if(a!==c)return e;var l=a-10,u=a+10;return e.forEach((function(t,c){if(1===t.value[0]&&0===t.value[2]){var o=t.value[3],i=t.value[4],s=t.value[5],d=t.value[6];s-o>Math.abs(d-i)||l<=d&&d<=u&&n<=s&&s<=r&&(e=ne(e,c,2,32),e=ne(e,c,6,a))}})),e},se=n(39),de=x()("EDITOR"),pe={loadedBuhin:de("LOAD_BUHIN_DATA"),loadedStretchParam:de("LOAD_STRETCH_PARAM"),changeStrokeType:de("CHANGE_STROKE_TYPE"),changeHeadShapeType:de("CHANGE_HEAD_SHAPE_TYPE"),changeTailShapeType:de("CHANGE_TAIL_SHAPE_TYPE"),changeStretchCoeff:de("CHANGE_STRETCH_COEFF"),swapWithPrev:de("SWAP_WITH_PREV"),swapWithNext:de("SWAP_WITH_NEXT"),insertPart:de("ADD_PART"),paste:de("PASTE"),copy:de("COPY_SELECTION"),cut:de("CUT_SELECTION"),delete:de("DELETE_SELECTION"),decomposeSelected:de("DECOMPOSE_SELECTION"),moveSelected:de("MOVE_SELECTED"),toggleFreehand:de("TOGGLE_FREEHAND_MODE"),escape:de("PRESS_ESC_KEY"),finishEdit:de("FINISH_EDIT")},he=n(10),ve=n.n(he),fe=n(17),be=function(){var e=Object(fe.a)(ve.a.mark((function e(t){var n;return ve.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://asia-northeast1-ku6goma.cloudfunctions.net/gwproxy"+t);case 2:if((n=e.sent).ok){e.next=5;break}throw new Error("API error occurred");case 5:return e.t0=URLSearchParams,e.next=8,n.text();case 8:return e.t1=e.sent,e.abrupt("return",new e.t0(e.t1));case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),me=function(){var e=Object(fe.a)(ve.a.mark((function e(t){var n;return ve.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,be("/get_source.cgi?name=".concat(encodeURIComponent(t)));case 2:return n=e.sent,e.abrupt("return",n.get("data"));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ge=function(){var e=Object(fe.a)(ve.a.mark((function e(t){var n;return ve.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,be("/search4ge.cgi?query=".concat(encodeURIComponent(t)));case 2:return n=e.sent,e.abrupt("return",n.get("data"));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ye=new se.Kage,Oe=function(e,t,n){return ye.kBuhin.search=function(n){var a=e.get(n);return"undefined"===typeof a&&(a=(null===t||void 0===t?void 0:t(n))||""),a},"undefined"!==typeof n&&(ye.kShotai=n),ye},je=new Set,Ee=function(e){je.has(e)||(je.add(e),me(e).then((function(t){if("string"!==typeof t)throw new Error("failed to get buhin source of ".concat(e));var n=/^0:1:0:(-?\d+):(-?\d+):(-?\d+):(-?\d+)(?=$|\$)/.exec(t);if(n){var a=[+n[1]||0,+n[2]||0,+n[3]||0,+n[4]||0];Qe.dispatch(pe.loadedStretchParam([e,a]))}Qe.dispatch(pe.loadedBuhin([e,t])),je.delete(e)})).catch((function(e){return console.error(e)})))},ke=function(e,t){return e.length===t.length&&e.every((function(e,n){return e===t[n]}))},Se=Object(Y.a)((function(e,t,n){var a=e.map(d);return Oe(t,Ee,n).makeGlyphSeparated(a)}),(function(e,t){var n=Object(D.a)(e,3),a=n[0],r=n[1],c=n[2],l=Object(D.a)(t,3),u=l[0],o=l[1],i=l[2];return r===o&&c===i&&ke(a,u)})),Me=function(e){return Object(Y.a)((function(e,t,n){return Se(e,t,n)}),e)},Ce=Me(),we=Me((function(e,t){var n=Object(D.a)(e,3),a=n[0],r=n[1],c=n[2],l=Object(D.a)(t,3),u=l[0],o=l[1],i=l[2];return r===o&&c===i&&ke(a,u)})),Te=n(5),xe=function(e){var t=e.map((function(e){return Object(D.a)(e,1)[0]})),n=e.map((function(e){return Object(D.a)(e,2)[1]}));return[Math.min.apply(Math,Object(C.a)(t)),Math.min.apply(Math,Object(C.a)(n)),Math.max.apply(Math,Object(C.a)(t)),Math.max.apply(Math,Object(C.a)(n))]},Ne=function(e){switch(e.value[0]){case 99:return xe([[e.value[3],e.value[4]],[e.value[5],e.value[6]]]);case 0:case 1:case 2:case 3:case 4:case 6:case 7:case 9:for(var t=[],n=3;n+2<=e.value.length;n+=2)t.push([e.value[n],e.value[n+1]]);return xe(t);default:return xe([])}},Ie=function(e,t){var n=Object(D.a)(e,4),a=n[0],r=n[1],c=n[2],l=n[3],u=Object(D.a)(t,4),o=u[0],i=u[1],s=u[2],d=u[3];return[Math.min(a,o),Math.min(r,i),Math.max(c,s),Math.max(l,d)]},De=Object(Y.a)((function(e){return e.map(Ne).reduce(Ie,xe([]))}),(function(e,t){var n=Object(D.a)(e,1)[0],a=Object(D.a)(t,1)[0];return n.length===a.length&&n.every((function(e,t){return e===a[t]}))})),_e=function(e,t,n,a,r){if(1===t.length){var c=e[t[0]];switch(c.value[0]){case 0:case 9:case 99:var l=c.value.slice();switch(n){case S.north:l[4]=Math.round(l[4]+r);break;case S.west:l[3]=Math.round(l[3]+a);break;case S.south:l[6]=Math.round(l[6]+r);break;case S.east:l[5]=Math.round(l[5]+a);break;case S.southeast:l[5]=Math.round(l[5]+a),l[6]=Math.round(l[6]+r)}var u=99===c.value[0]?{value:l,partName:c.partName}:{value:l};return e.map((function(e,n){return n===t[0]?u:e}))}}var o=De(t.map((function(t){return e[t]}))),i=o.slice();switch(n){case S.north:i[1]=Math.min(i[1]+r,i[3]-20);break;case S.west:i[0]=Math.min(i[0]+a,i[2]-20);break;case S.south:i[3]=Math.max(i[3]+r,i[1]+20);break;case S.east:i[2]=Math.max(i[2]+a,i[0]+20);break;case S.southeast:i[2]=Math.max(i[2]+a,i[0]+20),i[3]=Math.max(i[3]+r,i[1]+20)}return V(e,t,o,i)},Pe=Object(Te.a)([function(e){return e.glyph},function(e){return e.selection},function(e){return e.dragSelection},function(e){return e.dragPoint},function(e){return e.resizeSelection},function(e){return e.freehandStroke}],(function(e,t,n,a,r,c){if(n){var l=Object(D.a)(n,4),u=l[0],o=l[1],i=l[2],s=l[3];e=W(e,t,i-u,s-o)}else if(a){var d=Object(D.a)(a,2),p=d[0],h=Object(D.a)(d[1],4),v=h[0],f=h[1],b=h[2],m=h[3];e=K(e,t,p,b-v,m-f)}else if(r){var g=Object(D.a)(r,2),y=g[0],O=Object(D.a)(g[1],4),j=O[0],E=O[1],k=O[2],S=O[3];e=_e(e,t,y,k-j,S-E)}else c&&(e=Z(e,c));return e})),Re=function(e){return 99!==e.value[0]?null:[e.value[9],e.value[10],e.value[1],e.value[2]]},Le=function(e,t){if(99!==e.value[0])return e;var n=Object(D.a)(t,4),a=n[0],r=n[1],c=n[2],l=n[3],u=e.value.slice();return u[9]=Math.round(a),u[10]=Math.round(r),u[1]=Math.round(c),u[2]=Math.round(l),{value:u,partName:e.partName}},Ae=function(e){var t=Object(D.a)(e,4),n=t[0],a=t[1],r=t[2];return r<=100&&(r+=200,n=a=0),[n,a,r,t[3]]},Ge=function(e,t){var n=Object(D.a)(e,4),a=n[0],r=n[1],c=n[2],l=n[3];if(a===c&&r===l)return 0;var u,o=Ae(t),i=Object(D.a)(o,4),s=i[0],d=i[1],p=i[2],h=i[3];return s===p-200&&d===h?0:(u=Math.round(Math.abs(a-c)>Math.abs(r-l)?(p-100-a)/(c-a)*20:(h+100-r)/(l-r)*20),Math.max(-10,Math.min(10,u))||0)},Ye=function(e,t){return e.map((function(e){return function(e,t){return Oe(t).getEachStrokes(d(e)).map((function(e){var t=s(e.a1);return{value:[e.a1,e.a2_100+100*e.kirikuchiAdjustment+1e3*e.tateAdjustment,e.a3_100+100*e.opt3+1e3*e.mageAdjustment,Math.round(e.x1)||0,Math.round(e.y1)||0,Math.round(e.x2)||0,Math.round(e.y2)||0,Math.round(e.x3)||0,Math.round(e.y3)||0,Math.round(e.x4)||0,Math.round(e.y4)||0].slice(0,t)}}))}(e,t)})).reduce((function(e,t){return e.concat(t)}),[])},Xe=[1,2,3,4,6,7],He={1:[0,2,32,12,22],2:[0,32,12,22,7,27],3:[0,32,12,22],4:[0,22],6:[0,32,12,22,7,27],7:[0,32,12,22]},ze={1:[0,2,32,13,23,4,313,413,24],2:[7,0,8,4,5],3:[0,5],4:[0,5],6:[7,0,8,4,5],7:[7]},Ue=[[1,0,0],[1,0,2],[1,0,32],[1,0,13],[1,0,23],[1,0,4],[1,0,313],[1,0,413],[1,0,24],[1,2,0],[1,2,2],[1,32,0],[1,32,32],[1,32,13],[1,32,23],[1,32,4],[1,32,313],[1,32,413],[1,32,24],[1,12,0],[1,12,32],[1,12,13],[1,12,23],[1,12,313],[1,12,413],[1,12,24],[1,22,0],[1,22,32],[1,22,13],[1,22,23],[1,22,4],[1,22,313],[1,22,413],[1,22,24],[2,0,7],[2,0,5],[2,32,7],[2,32,4],[2,32,5],[2,12,7],[2,22,7],[2,22,4],[2,22,5],[2,7,0],[2,7,8],[2,7,4],[2,27,0],[3,0,0],[3,0,5],[3,32,0],[3,32,5],[3,12,0],[3,12,5],[3,22,0],[3,22,5],[4,0,0],[4,0,5],[4,22,0],[4,22,5],[6,0,7],[6,0,5],[6,32,7],[6,32,4],[6,32,5],[6,12,7],[6,22,7],[6,22,4],[6,22,5],[6,7,0],[6,7,8],[6,7,4],[6,27,0],[7,0,7],[7,32,7],[7,12,7],[7,22,7]],Fe=Object(Y.a)((function(e){return!Xe.includes(e.value[0])||Ue.some((function(t){var n=Object(D.a)(t,3),a=n[0],r=n[1],c=n[2];return a===e.value[0]&&r===e.value[1]&&c===e.value[2]}))})),qe=function(e,t,n){var a=e.slice();return a[t]=n,a},Be=x()("DISPLAY"),We={openOptionModal:Be("OPEN_OPTION_MODAL"),closeOptionModal:Be("CLOSE_OPTION_MODAL"),setGridDisplay:Be("SET_GRID_DISPLAY"),setGridOriginX:Be("SET_GRID_ORIGIN_X"),setGridOriginY:Be("SET_GRID_ORIGIN_Y"),setGridSpacingX:Be("SET_GRID_SPACING_X"),setGridSpacingY:Be("SET_GRID_SPACING_Y"),setShotai:Be("SET_SHOTAI"),setStrokeCenterLineDisplay:Be("SET_STROKE_CENTER_LINE_DISPLAY")},Ke=x()("UNDO"),Ve={undo:Ke("UNDO"),redo:Ke("REDO")},$e={glyph:p(M.data),selection:[],areaSelectRect:null,dragSelection:null,dragPoint:null,resizeSelection:null,freehandStroke:null,ctmInv:null,freehandMode:!1,buhinMap:new Map,stretchParamMap:new Map,clipboard:[],undoStacks:{undo:[],redo:[]},exitEvent:null,showOptionModal:!1,grid:{display:!0,originX:0,originY:0,spacingX:20,spacingY:20},showStrokeCenterLine:!1,shotai:0},Je=function(e){var t=e(void 0,{type:"_INIT"});return Object(i.reducerWithInitialState)(t).case(Ve.undo,(function(e){return 0===e.undoStacks.undo.length?e:Object(w.a)(Object(w.a)({},e),{},{glyph:e.undoStacks.undo[e.undoStacks.undo.length-1],selection:[],undoStacks:{undo:e.undoStacks.undo.slice(0,-1),redo:e.undoStacks.redo.concat([e.glyph])}})})).case(Ve.redo,(function(e){return 0===e.undoStacks.redo.length?e:Object(w.a)(Object(w.a)({},e),{},{glyph:e.undoStacks.redo[e.undoStacks.redo.length-1],selection:[],undoStacks:{undo:e.undoStacks.undo.concat([e.glyph]),redo:e.undoStacks.redo.slice(0,-1)}})})).default((function(t,n){var a=e(t,n);return t?function(e,t){return n=e.glyph,a=t.glyph,n===a||n.length===a.length&&n.every((function(e,t){var n=a[t];return e===n||e.partName===n.partName&&e.value.length===n.value.length&&e.value.every((function(e,t){return e===n.value[t]}))}))?t:Object(w.a)(Object(w.a)({},t),{},{undoStacks:{undo:e.undoStacks.undo.concat([e.glyph]).slice(-30),redo:[]}});var n,a}(t,a):a}))}(Object(i.reducerWithInitialState)($e).withHandling((function(e){return e.case(I.selectSingle,(function(e,t){return Object(w.a)(Object(w.a)({},e),{},{selection:[t]})})).case(I.selectAddSingle,(function(e,t){return Object(w.a)(Object(w.a)({},e),{},{selection:e.selection.includes(t)?e.selection:e.selection.concat([t])})})).case(I.selectRemoveSingle,(function(e,t){return Object(w.a)(Object(w.a)({},e),{},{selection:e.selection.filter((function(e){return t!==e}))})})).case(I.selectAll,(function(e){return Object(w.a)(Object(w.a)({},e),{},{selection:e.glyph.map((function(e,t){return t}))})})).case(I.selectDeselected,(function(e){return Object(w.a)(Object(w.a)({},e),{},{selection:e.glyph.map((function(e,t){return t})).filter((function(t){return!e.selection.includes(t)}))})})).case(I.selectNone,(function(e){return Object(w.a)(Object(w.a)({},e),{},{selection:[]})})).case(I.selectPrev,(function(e){if(0===e.glyph.length)return Object(w.a)(Object(w.a)({},e),{},{selection:[]});var t=0===e.selection.length?0:Math.min.apply(Math,Object(C.a)(e.selection));return Object(w.a)(Object(w.a)({},e),{},{selection:[(t-1+e.glyph.length)%e.glyph.length]})})).case(I.selectNext,(function(e){if(0===e.glyph.length)return Object(w.a)(Object(w.a)({},e),{},{selection:[]});var t=0===e.selection.length?-1:Math.max.apply(Math,Object(C.a)(e.selection));return Object(w.a)(Object(w.a)({},e),{},{selection:[(t+1+e.glyph.length)%e.glyph.length]})}))})).withHandling((function(e){return e.case(A.startBackgroundDrag,(function(e,t){if(!e.ctmInv)return e;var n=e.ctmInv(t.clientX,t.clientY),a=Object(D.a)(n,2),r=a[0],c=a[1];return e.freehandMode?Object(w.a)(Object(w.a)({},e),{},{freehandStroke:[[r,c]]}):Object(w.a)(Object(w.a)({},e),{},{areaSelectRect:[r,c,r,c]})})).case(A.startSelectionDrag,(function(e,t){if(!e.ctmInv)return e;var n=e.ctmInv(t.clientX,t.clientY),a=Object(D.a)(n,2),r=a[0],c=a[1];return Object(w.a)(Object(w.a)({},e),{},{dragSelection:[r,c,r,c]})})).case(A.startPointDrag,(function(e,t){var n=Object(D.a)(t,2),a=n[0],r=n[1];if(!e.ctmInv)return e;var c=e.ctmInv(a.clientX,a.clientY),l=Object(D.a)(c,2),u=l[0],o=l[1];return Object(w.a)(Object(w.a)({},e),{},{dragPoint:[r,[u,o,u,o]]})})).case(A.startResize,(function(e,t){var n=Object(D.a)(t,2),a=n[0],r=n[1];if(!e.ctmInv)return e;var c=e.ctmInv(a.clientX,a.clientY),l=Object(D.a)(c,2),u=l[0],o=l[1];return Object(w.a)(Object(w.a)({},e),{},{resizeSelection:[r,[u,o,u,o]]})})).case(A.mouseMove,(function(e,t){if(!e.ctmInv)return e;if(e.areaSelectRect){var n=Object(D.a)(e.areaSelectRect,2),a=n[0],r=n[1],c=e.ctmInv(t.clientX,t.clientY),l=Object(D.a)(c,2),u=l[0],o=l[1];return Object(w.a)(Object(w.a)({},e),{},{areaSelectRect:[a,r,u,o]})}if(e.dragSelection){var i=Object(D.a)(e.dragSelection,2),s=i[0],d=i[1],p=e.ctmInv(t.clientX,t.clientY),h=Object(D.a)(p,2),v=h[0],f=h[1];return Object(w.a)(Object(w.a)({},e),{},{dragSelection:[s,d,v,f]})}if(e.dragPoint){var b=Object(D.a)(e.dragPoint,2),m=b[0],g=Object(D.a)(b[1],2),y=g[0],O=g[1],j=e.ctmInv(t.clientX,t.clientY),E=Object(D.a)(j,2),k=E[0],S=E[1];return Object(w.a)(Object(w.a)({},e),{},{dragPoint:[m,[y,O,k,S]]})}if(e.resizeSelection){var M=Object(D.a)(e.resizeSelection,2),C=M[0],T=Object(D.a)(M[1],2),x=T[0],N=T[1],I=e.ctmInv(t.clientX,t.clientY),_=Object(D.a)(I,2),P=_[0],R=_[1];return Object(w.a)(Object(w.a)({},e),{},{resizeSelection:[C,[x,N,P,R]]})}if(e.freehandStroke){var L=e.ctmInv(t.clientX,t.clientY),A=Object(D.a)(L,2),G=A[0],Y=A[1],X=e.freehandStroke.concat([[G,Y]]);if(X.length>=3){var H=Object(D.a)(X[X.length-2],2),z=H[0],U=H[1];Math.abs(G-z)<2&&Math.abs(Y-U)<2&&X.splice(X.length-2,1)}return Object(w.a)(Object(w.a)({},e),{},{freehandStroke:X})}return e})).case(A.mouseUp,(function(e,t){if(!e.ctmInv)return e;if(e.areaSelectRect){var n=Object(D.a)(e.areaSelectRect,2),a=n[0],r=n[1],c=e.ctmInv(t.clientX,t.clientY),l=Object(D.a)(c,2),u=l[0],o=l[1],i=function(e,t,n,a,r,c,l){for(var u=Ce(e,t,n),o=[],i=[[a,r],[a,l],[c,l],[c,r],[a,r]],s=0;s<u.length;s++){u[s].array.some((function(e){var t=e.array.map((function(e){return[e.x,e.y]}));return t.push(t[0]),Object(_.a)(i,t)||Object(_.a)(t,i)||Object(_.b)(i,t)}))&&o.push(s)}return o}(e.glyph,e.buhinMap,e.shotai,a,r,u,o),s=Array.from(new Set(e.selection.concat(i)));return Object(w.a)(Object(w.a)({},e),{},{selection:s,areaSelectRect:null})}if(e.dragSelection){var d=Object(D.a)(e.dragSelection,2),p=d[0],h=d[1],v=e.ctmInv(t.clientX,t.clientY),f=Object(D.a)(v,2),b=f[0],m=f[1],g=W(e.glyph,e.selection,b-p,m-h);return Object(w.a)(Object(w.a)({},e),{},{glyph:g,dragSelection:null})}if(e.dragPoint){var y=Object(D.a)(e.dragPoint,2),O=y[0],j=Object(D.a)(y[1],2),E=j[0],k=j[1],S=e.ctmInv(t.clientX,t.clientY),M=Object(D.a)(S,2),C=M[0],T=M[1],x=K(e.glyph,e.selection,O,C-E,T-k);return Object(w.a)(Object(w.a)({},e),{},{glyph:x,dragPoint:null})}if(e.resizeSelection){var N=Object(D.a)(e.resizeSelection,2),I=N[0],P=Object(D.a)(N[1],2),R=P[0],L=P[1],A=e.ctmInv(t.clientX,t.clientY),G=Object(D.a)(A,2),Y=G[0],X=G[1],H=_e(e.glyph,e.selection,I,Y-R,X-L);return Object(w.a)(Object(w.a)({},e),{},{glyph:H,resizeSelection:null})}if(e.freehandStroke){var z=e.ctmInv(t.clientX,t.clientY),U=Object(D.a)(z,2),F=U[0],q=U[1],B=e.freehandStroke.concat([[F,q]]),V=Z(e.glyph,B);return Object(w.a)(Object(w.a)({},e),{},{glyph:V,freehandStroke:null})}return e})).case(A.updateCTMInv,(function(e,t){return Object(w.a)(Object(w.a)({},e),{},{ctmInv:t})}))})).withHandling((function(e){return e.case(pe.loadedBuhin,(function(e,t){var n=Object(D.a)(t,2),a=n[0],r=n[1],c=new Map(e.buhinMap);return c.set(a,r),Object(w.a)(Object(w.a)({},e),{},{buhinMap:c})})).case(pe.loadedStretchParam,(function(e,t){var n=Object(D.a)(t,2),a=n[0],r=n[1],c=new Map(e.stretchParamMap);return c.set(a,r),Object(w.a)(Object(w.a)({},e),{},{stretchParamMap:c})})).case(pe.changeStrokeType,(function(e,t){if(1!==e.selection.length)return e;var n=e.selection[0],a=function(e,t){var n=e.value[0];if(!Xe.includes(n)||!Xe.includes(t))return e;var a={value:e.value.slice()};a.value[0]=t,He[t].includes(a.value[1])||(a.value[1]=He[t][0]),ze[t].includes(a.value[2])||(a.value[2]=ze[t][0]);var r=(s(n)-3)/2,c=(s(t)-3)/2;if(r===c)return a;if(2===r&&3===c){var l=a.value[3],u=a.value[4],o=a.value[5],i=a.value[6],d=Math.round((l+o)/2),p=Math.round((u+i)/2);return a.value=a.value.slice(0,3).concat([l,u,d,p,o,i]),a}if(2===r&&4===c){var h=a.value[3],v=a.value[4],f=a.value[5],b=a.value[6],m=Math.round((2*h+f)/3),g=Math.round((2*v+b)/3),y=Math.round((h+2*f)/3),O=Math.round((v+2*b)/3);return a.value=a.value.slice(0,3).concat([h,v,m,g,y,O,f,b]),a}if(3===r&&2===c){var j=a.value[3],E=a.value[4],k=a.value[7],S=a.value[8];return a.value=a.value.slice(0,3).concat([j,E,k,S]),a}if(3===r&&4===c){var M=a.value[3],C=a.value[4],w=a.value[5],T=a.value[6],x=a.value[7],N=a.value[8],I=Math.round((M+2*w)/3),D=Math.round((C+2*T)/3),_=Math.round((x+2*w)/3),P=Math.round((N+2*T)/3);return a.value=a.value.slice(0,3).concat([M,C,I,D,_,P,x,N]),a}if(4===r&&2===c){var R=a.value[3],L=a.value[4],A=a.value[9],G=a.value[10];return a.value=a.value.slice(0,3).concat([R,L,A,G]),a}if(4===r&&3===c){var Y=a.value[3],X=a.value[4],H=a.value[5],z=a.value[6],U=a.value[7],F=a.value[8],q=a.value[9],B=a.value[10],W=Math.round((H+U)/2),K=Math.round((z+F)/2);return a.value=a.value.slice(0,3).concat([Y,X,W,K,q,B]),a}return a}(e.glyph[n],t);return Object(w.a)(Object(w.a)({},e),{},{glyph:qe(e.glyph,n,a)})})).case(pe.changeHeadShapeType,(function(e,t){if(1!==e.selection.length)return e;var n=e.selection[0],a=Object(w.a)(Object(w.a)({},e.glyph[n]),{},{value:e.glyph[n].value.slice()});return a.value[1]=t,Object(w.a)(Object(w.a)({},e),{},{glyph:qe(e.glyph,n,a)})})).case(pe.changeTailShapeType,(function(e,t){if(1!==e.selection.length)return e;var n=e.selection[0],a=Object(w.a)(Object(w.a)({},e.glyph[n]),{},{value:e.glyph[n].value.slice()});return a.value[2]=t,Object(w.a)(Object(w.a)({},e),{},{glyph:qe(e.glyph,n,a)})})).case(pe.changeStretchCoeff,(function(e,t){if(1!==e.selection.length)return e;var n=e.selection[0],a=e.glyph[n];if(!a.partName)return e;var r=e.stretchParamMap.get(a.partName);if(!r)return e;var c=Le(e.glyph[n],function(e,t){var n=Object(D.a)(e,4),a=n[0],r=n[1];return[a-100,r-100,a+(n[2]-a)*t/20+100,r+(n[3]-r)*t/20-100]}(r,t));return Object(w.a)(Object(w.a)({},e),{},{glyph:qe(e.glyph,n,c)})})).case(pe.swapWithPrev,(function(e){if(1!==e.selection.length)return e;var t=e.selection[0];if(0===t)return e;var n=e.glyph.slice();return n[t-1]=e.glyph[t],n[t]=e.glyph[t-1],Object(w.a)(Object(w.a)({},e),{},{glyph:n,selection:[t-1]})})).case(pe.swapWithNext,(function(e){if(1!==e.selection.length)return e;var t=e.selection[0];if(t===e.glyph.length-1)return e;var n=e.glyph.slice();return n[t+1]=e.glyph[t],n[t]=e.glyph[t+1],Object(w.a)(Object(w.a)({},e),{},{glyph:n,selection:[t+1]})})).case(pe.insertPart,(function(e,t){return Object(w.a)(Object(w.a)({},e),{},{glyph:e.glyph.concat([{value:[99,0,0,0,0,200,200,0,0,0,0],partName:t}]),selection:[e.glyph.length]})})).case(pe.paste,(function(e){return Object(w.a)(Object(w.a)({},e),{},{glyph:e.glyph.concat(e.clipboard),selection:e.clipboard.map((function(t,n){return e.glyph.length+n}))})})).case(pe.copy,(function(e){var t=e.selection.map((function(t){return e.glyph[t]})),n=De(t),a=Object(D.a)(n,2),r=a[0],c=a[1],l=function(e){return 230+e-r},u=function(e){return 20+e-c};return Object(w.a)(Object(w.a)({},e),{},{clipboard:e.selection.map((function(t){return q(e.glyph[t],l,u)}))})})).case(pe.cut,(function(e){return Object(w.a)(Object(w.a)({},e),{},{glyph:e.glyph.filter((function(t,n){return!e.selection.includes(n)})),clipboard:e.selection.map((function(t){return e.glyph[t]})),selection:[]})})).case(pe.delete,(function(e){return Object(w.a)(Object(w.a)({},e),{},{glyph:e.glyph.filter((function(t,n){return!e.selection.includes(n)})),selection:[]})})).case(pe.decomposeSelected,(function(e){var t=[],n=[];return e.glyph.forEach((function(a,r){if(e.selection.includes(r)){var c=function(e,t){if(99!==e.value[0])return[e];var n=t.get(e.partName);if(!n)return[e];var a=!1,r=Oe(t,(function(){a=!0})),c=p(n),l=r.getEachStrokes(h(c)),u=r.getBox(l),o=e.value[3],i=e.value[4],s=e.value[5],d=e.value[6],v=Ae(Re(e)),f=Object(D.a)(v,4),b=f[0],m=f[1],g=f[2],y=f[3],O=!(b===g-200&&m===y);return O&&a?[e]:c.map((function(e){var t=q(e,(function(e){var t=O?r.stretch(g-200,b,e,u.minX,u.maxX):e;return Math.round(t/200*(s-o)+o)}),(function(e){var t=O?r.stretch(y,m,e,u.minY,u.maxY):e;return Math.round(t/200*(d-i)+i)}));if(!O||99!==t.value[0])return t;var n=Ae(Re(t)),a=Object(D.a)(n,4),c=a[0],l=a[1],p=a[2],h=a[3];if(c!==p-200||l!==h)return t;var v=t.value[3],f=t.value[4],j=t.value[5],E=t.value[6];if(v===j||f===E)return t;var k=function(e){return(e-v)/(j-v)*200},S=function(e){return(e-f)/(E-f)*200};return Le(t,[k(b+100)-100,S(m+100)-100,k(g-100)+100,S(y+100)-100])}))}(a,e.buhinMap);n=n.concat(c.map((function(e,n){return t.length+n}))),t=t.concat(c)}else t.push(a)})),Object(w.a)(Object(w.a)({},e),{},{glyph:t,selection:n})})).case(pe.moveSelected,(function(e,t){var n=Object(D.a)(t,2),a=n[0],r=n[1];return Object(w.a)(Object(w.a)({},e),{},{glyph:W(e.glyph,e.selection,a,r)})})).case(pe.toggleFreehand,(function(e){return Object(w.a)(Object(w.a)({},e),{},{selection:e.freehandMode?e.selection:[],freehandMode:!e.freehandMode})})).case(pe.escape,(function(e){return e.showOptionModal?Object(w.a)(Object(w.a)({},e),{},{showOptionModal:!1}):e.freehandMode?Object(w.a)(Object(w.a)({},e),{},{freehandMode:!1}):e.selection.length?Object(w.a)(Object(w.a)({},e),{},{selection:[]}):e})).case(pe.finishEdit,(function(e,t){return Object(w.a)(Object(w.a)({},e),{},{exitEvent:t})}))})).withHandling((function(e){return e.case(We.openOptionModal,(function(e){return Object(w.a)(Object(w.a)({},e),{},{showOptionModal:!0})})).case(We.closeOptionModal,(function(e){return Object(w.a)(Object(w.a)({},e),{},{showOptionModal:!1})})).case(We.setGridDisplay,(function(e,t){return Object(w.a)(Object(w.a)({},e),{},{grid:Object(w.a)(Object(w.a)({},e.grid),{},{display:t})})})).case(We.setGridOriginX,(function(e,t){return Object(w.a)(Object(w.a)({},e),{},{grid:Object(w.a)(Object(w.a)({},e.grid),{},{originX:t})})})).case(We.setGridOriginY,(function(e,t){return Object(w.a)(Object(w.a)({},e),{},{grid:Object(w.a)(Object(w.a)({},e.grid),{},{originY:t})})})).case(We.setGridSpacingX,(function(e,t){return Object(w.a)(Object(w.a)({},e),{},{grid:Object(w.a)(Object(w.a)({},e.grid),{},{spacingX:t})})})).case(We.setGridSpacingY,(function(e,t){return Object(w.a)(Object(w.a)({},e),{},{grid:Object(w.a)(Object(w.a)({},e.grid),{},{spacingY:t})})})).case(We.setStrokeCenterLineDisplay,(function(e,t){return Object(w.a)(Object(w.a)({},e),{},{showStrokeCenterLine:t})})).case(We.setShotai,(function(e,t){return Object(w.a)(Object(w.a)({},e),{},{shotai:t})}))}))),Qe=Object(o.b)(Je),Ze=(n(67),function(){var e=Object(u.d)((function(e){return e.grid}));if(!e.display)return r.a.createElement(r.a.Fragment,null);for(var t=[],n=e.originX;n<200;n+=e.spacingX)t.push(n);for(var a=[],c=e.originY;c<200;c+=e.spacingY)a.push(c);return r.a.createElement("g",{className:"grid-lines"},t.map((function(e){return r.a.createElement("path",{key:e,d:"M ".concat(e," 0 V 200")})})),a.map((function(e){return r.a.createElement("path",{key:e,d:"M 0 ".concat(e," H 200")})})))}),et=function(e){return r.a.createElement(r.a.Fragment,null,e.polygons.array.map((function(e,t){return r.a.createElement("polygon",{key:t,points:e.array.map((function(e){var t=e.x,n=e.y;return"".concat(t,",").concat(n," ")})).join("")})})))},tt=(n(68),function(e){var t=(e.makeGlyphSeparated||Ce)(e.glyph,e.buhinMap,e.shotai),n=e.selection,a=t.map((function(e,t){return t})).filter((function(e){return!n.includes(e)}));return r.a.createElement(r.a.Fragment,null,r.a.createElement("g",{className:"strokes-deselected"},a.map((function(n){return r.a.createElement("g",{key:n,onMouseDown:function(t){var a;return null===(a=e.handleMouseDownDeselectedStroke)||void 0===a?void 0:a.call(e,t,n)}},r.a.createElement(et,{polygons:t[n]}))}))),r.a.createElement("g",{className:"strokes-selected"},n.map((function(n){return r.a.createElement("g",{key:n,onMouseDown:function(t){var a;return null===(a=e.handleMouseDownSelectedStroke)||void 0===a?void 0:a.call(e,t,n)}},r.a.createElement(et,{polygons:t[n]}))}))))}),nt=(n(69),function(e){var t=Ye(e.glyph,e.buhinMap);return r.a.createElement("g",{className:"stroke-center-line"},t.map((function(e,t){var n=e.value;switch(n[0]){case 1:return r.a.createElement("path",{key:t,d:"M ".concat(n[3]," ").concat(n[4]," ").concat(n[5]," ").concat(n[6])});case 2:return r.a.createElement("path",{key:t,d:"M ".concat(n[3]," ").concat(n[4]," Q ").concat(n[5]," ").concat(n[6]," ").concat(n[7]," ").concat(n[8])});case 3:case 4:return r.a.createElement("path",{key:t,d:"M ".concat(n[3]," ").concat(n[4]," ").concat(n[5]," ").concat(n[6]," ").concat(n[7]," ").concat(n[8])});case 6:return r.a.createElement("path",{key:t,d:"M ".concat(n[3]," ").concat(n[4]," C ").concat(n[5]," ").concat(n[6]," ").concat(n[7]," ").concat(n[8]," ").concat(n[9]," ").concat(n[10])});case 7:return r.a.createElement("path",{key:t,d:"M ".concat(n[3]," ").concat(n[4]," ").concat(n[5]," ").concat(n[6]," Q ").concat(n[7]," ").concat(n[8]," ").concat(n[9]," ").concat(n[10])});default:return null}})))});!function(e){e[e.none=0]="none",e[e.online=1]="online",e[e.match=2]="match"}(R||(R={}));var at=function(e,t){var n=e[t.lineIndex],a=(s(n.value[0])-3)/2-1;if(0!==t.pointIndex&&t.pointIndex!==a)return R.none;for(var r=n.value[3+2*t.pointIndex],c=n.value[3+2*t.pointIndex+1],l=function(e,t,n,a){return e===n&&e===r&&t<=c&&c<=a||t===a&&t===c&&e<=r&&r<=n},u=R.none,o=0;o<e.length;o++)if(t.lineIndex!==o){var i=e[o];if(![0,9,99].includes(i.value[0])){if(i.value[3]===r&&i.value[4]===c)return R.match;var d=(s(i.value[0])-3)/2-1;if(i.value[3+2*d]===r&&i.value[3+2*d+1]===c)return R.match;switch(i.value[0]){case 3:case 4:(l(i.value[3],i.value[4],i.value[5],i.value[6])||l(i.value[5],i.value[6],i.value[7],i.value[8]))&&(u=R.online);break;case 1:case 7:l(i.value[3],i.value[4],i.value[5],i.value[6])&&(u=R.online)}}}return u},rt=(n(70),function(e){return r.a.createElement("rect",{x:e.x-4,y:e.y-4,width:8,height:8,className:"controlpoint-rect ".concat(e.className||""),onMouseDown:e.handleMouseDown})}),ct=(n(71),Object(Te.a)([Pe,function(e){return e.selection}],(function(e,t){if(0===t.length)return{rectControl:null,pointControl:[]};if(t.length>1){var n=t.map((function(t){return e[t]}));return{rectControl:{multiSelect:!0,coords:De(n)},pointControl:[]}}var a=e[t[0]];switch(a.value[0]){case 0:case 9:case 99:return{rectControl:{multiSelect:!1,coords:[a.value[3],a.value[4],a.value[5],a.value[6]]},pointControl:[]};case 1:case 2:case 3:case 4:case 6:case 7:for(var r=[],c=3;c+2<=a.value.length;c+=2){var l=at(e,{lineIndex:t[0],pointIndex:(c-3)/2}),u="";l===R.match?u="match":l===R.online&&(u="online"),r.push({x:a.value[c],y:a.value[c+1],className:u})}return{rectControl:null,pointControl:r};default:return{rectControl:null,pointControl:[]}}}))),lt=function(){var e=Object(u.d)(ct),t=e.rectControl,n=e.pointControl,c=Object(u.c)(),l=Object(a.useCallback)((function(e,t){c(A.startResize([e,t])),e.stopPropagation()}),[c]),o=Object(a.useCallback)((function(e){return l(e,S.north)}),[l]),i=Object(a.useCallback)((function(e){return l(e,S.west)}),[l]),s=Object(a.useCallback)((function(e){return l(e,S.south)}),[l]),d=Object(a.useCallback)((function(e){return l(e,S.east)}),[l]),p=Object(a.useCallback)((function(e){return l(e,S.southeast)}),[l]),h=Object(a.useMemo)((function(){return n.map((function(e,t){return function(e){c(A.startPointDrag([e,t])),e.stopPropagation()}}))}),[c,n]);return r.a.createElement(r.a.Fragment,null,t&&r.a.createElement(r.a.Fragment,null,r.a.createElement("rect",{className:"selection-rect",x:t.coords[0],y:t.coords[1],width:t.coords[2]-t.coords[0],height:t.coords[3]-t.coords[1]}),r.a.createElement(rt,{x:(t.coords[0]+t.coords[2])/2,y:t.coords[1],className:"north",handleMouseDown:o}),r.a.createElement(rt,{x:t.coords[0],y:(t.coords[1]+t.coords[3])/2,className:"west",handleMouseDown:i}),r.a.createElement(rt,{x:(t.coords[0]+t.coords[2])/2,y:t.coords[3],className:"south",handleMouseDown:s}),r.a.createElement(rt,{x:t.coords[2],y:(t.coords[1]+t.coords[3])/2,className:"east",handleMouseDown:d}),r.a.createElement(rt,{x:t.coords[2],y:t.coords[3],className:"southeast",handleMouseDown:p})),n.map((function(e,t){var n=e.x,a=e.y,c=e.className;return r.a.createElement(rt,{key:t,x:n,y:a,className:c,handleMouseDown:h[t]})})))},ut=(n(72),function(e){if(!e.rect)return null;var t=Object(D.a)(e.rect,4),n=t[0],a=t[1],c=t[2],l=t[3];if(n>c){var u=n;n=c,c=u}if(a>l){var o=a;a=l,l=o}return r.a.createElement("rect",{className:"areaselect-rect",x:n,y:a,width:c-n,height:l-a})}),ot=(n(73),function(){var e=Object(u.d)(Pe),t=Object(u.d)((function(e){return e.buhinMap})),n=Object(u.d)((function(e){return e.shotai})),c=Object(u.d)((function(e){return e.selection})),l=Object(u.d)((function(e){return e.areaSelectRect})),o=Object(u.d)((function(e){return e.freehandMode})),i=Object(u.d)((function(e){return e.showStrokeCenterLine})),s=o?"freehand":"",d=Object(u.c)(),p=Object(a.useCallback)((function(e){var t=e.currentTarget.getScreenCTM();if(t){var n=e.currentTarget.createSVGPoint(),a=t.inverse();d(A.updateCTMInv((function(e,t){n.x=e,n.y=t;var r=n.matrixTransform(a);return[r.x,r.y]})))}}),[d]),h=Object(a.useCallback)((function(e){e.shiftKey||e.ctrlKey||d(I.selectNone()),d(A.startBackgroundDrag(e))}),[d]),v=Object(a.useCallback)((function(e,t){e.shiftKey||e.ctrlKey?d(I.selectAddSingle(t)):d(I.selectSingle(t)),d(A.startSelectionDrag(e)),e.stopPropagation()}),[d]),f=Object(a.useCallback)((function(e,t){(e.shiftKey||e.ctrlKey)&&d(I.selectRemoveSingle(t)),d(A.startSelectionDrag(e)),e.stopPropagation()}),[d]);return Object(a.useEffect)((function(){var e=function(e){d(A.mouseMove(e))},t=function(e){d(A.mouseUp(e))};return document.addEventListener("mousemove",e),document.addEventListener("mouseup",t),function(){document.removeEventListener("mousemove",e),document.removeEventListener("mouseup",t)}}),[d]),r.a.createElement("div",{className:"glyph-area"},r.a.createElement("svg",{width:"100%",height:"100%",viewBox:"-20 -20 500 240",className:s,onMouseDownCapture:p,onMouseDown:h},r.a.createElement(Ze,null),r.a.createElement("rect",{x:"0",y:"0",width:"200",height:"200",className:"glyph-boundary"}),r.a.createElement("rect",{x:"12",y:"12",width:"176",height:"176",className:"glyph-guide"}),r.a.createElement(tt,{glyph:e,buhinMap:t,shotai:n,selection:c,handleMouseDownDeselectedStroke:v,handleMouseDownSelectedStroke:f}),i&&r.a.createElement(nt,{glyph:e,buhinMap:t}),r.a.createElement(lt,null),r.a.createElement(ut,{rect:l})))}),it=n(96),st=(n(74),Object(Te.a)([function(e){return e.selection},Pe],(function(e,t){return 1!==e.length?null:t[e[0]]}))),dt=Object(Te.a)([st],(function(e){if(!e)return null;if(!Xe.includes(e.value[0]))return null;for(var t=[],n=3;n+2<=e.value.length;n+=2)t.push("(".concat(e.value[n],",").concat(e.value[n+1],")"));return{strokeType:e.value[0],headShapeType:e.value[1],tailShapeType:e.value[2],validTypes:Fe(e),coordString:t.join(" \u2192 ")}})),pt=Object(Te.a)([st,function(e){return e.buhinMap},function(e){return e.stretchParamMap}],(function(e,t,n){if(!e)return null;if(99!==e.value[0])return null;var a=e.partName,r=t.get(a),c=null;if(r){var l=/^(?:0:1:0:[^$]+\$)?99:0:0:0:0:200:200:([^$]+)$/.exec(r);l&&(c=l[1])}var u=n.get(a),o=u?Ge(u,Re(e)):null;return{partName:a,entityName:c,coordString:"(".concat(e.value[3],",").concat(e.value[4],") \u2192 (").concat(e.value[5],",").concat(e.value[6],")"),stretchCoeff:o}})),ht=Object(Te.a)([function(e){return e.selection},st],(function(e,t){if(e.length>1)return{isMultiple:!0};if(0===e.length)return{isMultiple:!1};var n=t,a=n.value[0];if(Xe.includes(a)||99===a)return null;for(var r=[],c=3;c+2<=n.value.length;c+=2)r.push("(".concat(n.value[c],",").concat(n.value[c+1],")"));return{isMultiple:!1,coordString:r.join(" \u2192 ")}})),vt=Object(Te.a)([function(e){return e.glyph.length},function(e){return e.selection}],(function(e,t){var n=t.map((function(e){return e+1})).sort((function(e,t){return e-t})).join(",");return"".concat(n||"-"," / ").concat(e||"-")})),ft=Object(Te.a)([function(e){return e.glyph.length},function(e){return e.selection}],(function(e,t){return{swapPrevDisabled:1!==t.length||0===t[0],swapNextDisabled:1!==t.length||t[0]===e-1,selectPrevDisabled:0===e,selectNextDisabled:0===e}})),bt=function(){var e=Object(u.d)(dt),t=Object(u.d)(pt),n=Object(u.d)(ht),c=Object(u.d)(vt),l=Object(u.d)(ft,u.b),o=l.swapPrevDisabled,i=l.swapNextDisabled,s=l.selectPrevDisabled,d=l.selectNextDisabled,p=Object(u.c)(),h=Object(a.useCallback)((function(e){p(pe.changeStrokeType(+e.currentTarget.value))}),[p]),v=Object(a.useCallback)((function(e){p(pe.changeHeadShapeType(+e.currentTarget.value))}),[p]),f=Object(a.useCallback)((function(e){p(pe.changeTailShapeType(+e.currentTarget.value))}),[p]),b=Object(a.useCallback)((function(e){p(pe.changeStretchCoeff(+e.currentTarget.value))}),[p]),m=Object(a.useCallback)((function(){p(I.selectPrev())}),[p]),g=Object(a.useCallback)((function(){p(I.selectNext())}),[p]),y=Object(a.useCallback)((function(){p(pe.swapWithPrev())}),[p]),O=Object(a.useCallback)((function(){p(pe.swapWithNext())}),[p]),j=Object(it.a)().t;return r.a.createElement("div",{className:"select-control"},r.a.createElement("div",{className:"selected-info"},e&&r.a.createElement(r.a.Fragment,null,r.a.createElement("div",null,j("stroke type"),r.a.createElement("select",{value:e.strokeType,onChange:h},Xe.map((function(e){return r.a.createElement("option",{key:e,value:e},j("stroke type ".concat(e)))})))," ",j("head type"),r.a.createElement("select",{value:e.headShapeType,onChange:v},He[e.strokeType].map((function(t){return r.a.createElement("option",{key:t,value:t},j("head type ".concat(e.strokeType,"-").concat(t)))})))," ",j("tail type"),r.a.createElement("select",{value:e.tailShapeType,onChange:f},ze[e.strokeType].map((function(t){return r.a.createElement("option",{key:t,value:t},j("tail type ".concat(e.strokeType,"-").concat(t)))})))," ",!e.validTypes&&r.a.createElement("span",{className:"alert"},j("invalid stroke shape types"))),r.a.createElement("div",null,e.coordString)),t&&r.a.createElement(r.a.Fragment,null,r.a.createElement("div",null,j("part")," ",r.a.createElement("strong",null,t.partName)," ",t.entityName&&j("alias of",{entity:t.entityName})),r.a.createElement("div",null,t.coordString),null!==t.stretchCoeff&&r.a.createElement("div",null,j("stretch")," ",r.a.createElement("input",{type:"range",min:-10,max:10,value:t.stretchCoeff,onChange:b})," ",t.stretchCoeff)),n&&r.a.createElement(r.a.Fragment,null,n.isMultiple&&r.a.createElement("div",null,j("selecting multiple strokes")),n.coordString&&r.a.createElement("div",null,n.coordString))),r.a.createElement("div",{className:"selection-control"},r.a.createElement("button",{disabled:o,onClick:y},j("swap with prev")),r.a.createElement("button",{className:"select-prevnext-button",disabled:s,onClick:m},j("select prev")),r.a.createElement("div",{className:"selection-num"},c),r.a.createElement("button",{className:"select-prevnext-button",disabled:d,onClick:g},j("select next")),r.a.createElement("button",{disabled:i,onClick:O},j("swap with next"))))},mt=Object(Te.a)([Pe],(function(e){return e.filter((function(e){return Ne(e)[0]<200}))})),gt=function(){var e=Object(u.d)(mt),t=Object(u.d)((function(e){return e.buhinMap})),n=Object(u.d)((function(e){return e.shotai}));return r.a.createElement("svg",{className:"preview-thumbnail",viewBox:"0 0 200 200",width:"50",height:"50"},r.a.createElement(tt,{buhinMap:t,glyph:e,shotai:n,selection:[],makeGlyphSeparated:we}))},yt=(n(80),function(){var e=Object(u.d)((function(e){return e.glyph})),t=Object(u.d)((function(e){return e.selection})),n=Object(u.d)((function(e){return e.clipboard})),c=Object(u.d)((function(e){return e.freehandMode})),l=0===Object(u.d)((function(e){return e.undoStacks.undo.length})),o=0===Object(u.d)((function(e){return e.undoStacks.redo.length})),i=0===n.length,s=!t.some((function(t){return 99===e[t].value[0]})),d=Object(u.c)(),p=Object(a.useCallback)((function(){d(Ve.undo())}),[d]),h=Object(a.useCallback)((function(){d(Ve.redo())}),[d]),v=Object(a.useCallback)((function(){d(I.selectAll())}),[d]),f=Object(a.useCallback)((function(){d(I.selectDeselected())}),[d]),b=Object(a.useCallback)((function(){d(pe.copy())}),[d]),m=Object(a.useCallback)((function(){d(pe.paste())}),[d]),g=Object(a.useCallback)((function(){d(pe.cut())}),[d]),y=Object(a.useCallback)((function(){d(pe.toggleFreehand())}),[d]),O=Object(a.useCallback)((function(){d(pe.decomposeSelected())}),[d]),j=Object(a.useCallback)((function(){d(We.openOptionModal())}),[d]),E=Object(a.useCallback)((function(e){d(pe.finishEdit(e.nativeEvent))}),[d]),k=Object(it.a)().t;return r.a.createElement("div",{className:"editor-controls"},r.a.createElement(bt,null),r.a.createElement("div",{className:"control-buttons"},r.a.createElement("button",{disabled:l,onClick:p},k("undo")),r.a.createElement("button",{disabled:o,onClick:h},k("redo")),r.a.createElement("button",{disabled:0===e.length,onClick:v},k("select all")),r.a.createElement("button",{disabled:0===e.length,onClick:f},k("invert selection")),r.a.createElement("button",{disabled:0===t.length,onClick:b},k("copy")),r.a.createElement("button",{disabled:i,onClick:m},k("paste")),r.a.createElement("button",{disabled:0===t.length,onClick:g},k("cut")),r.a.createElement("button",{onClick:y},k(c?"end freehand":"start freehand")),r.a.createElement("button",{disabled:s,onClick:O},k("decompose")),r.a.createElement("button",{onClick:j},k("options"))),r.a.createElement("div",{className:"preview"},r.a.createElement(gt,null),r.a.createElement("button",{onClick:E},k("finish edit"))))}),Ot=n(43),jt=n(44),Et=n(47),kt=n(48),St=(n(81),function(e){return"https://glyphwiki.org/glyph/".concat(e,".50px.png")}),Mt=function(e){var t=e.handleItemClick,n=e.handleItemMouseEnter,c=Object(a.useCallback)((function(e){var n=e.currentTarget.dataset.name;t(n,e)}),[t]),l=Object(a.useCallback)((function(e){var t=e.currentTarget.dataset.name;n(t,e)}),[n]);return r.a.createElement("div",{className:"parts-list"},e.names.map((function(e){return r.a.createElement("img",{key:e,alt:e,title:e,"data-name":e,src:St(e),width:50,height:50,onClick:c,onMouseEnter:l})})))},Ct=(n(82),["\u30a8\u30c7\u30a3\u30bf\u90e8\u54c11","\u30a8\u30c7\u30a3\u30bf\u90e8\u54c12","\u30a8\u30c7\u30a3\u30bf\u90e8\u54c13","\u30a8\u30c7\u30a3\u30bf\u90e8\u54c14"]),wt=M.name||"",Tt=function(e){Object(jt.a)(n,e);var t=Object(Et.a)(n);function n(){return Object(Ot.a)(this,n),t.apply(this,arguments)}return n}(Object(kt.a)(Error)),xt={query:"",result:[],err:null},Nt=function(){var e=Object(a.useRef)(null),t=Object(a.useState)(xt),n=Object(D.a)(t,2),c=n[0],l=n[1],o=function(e){l({query:e,result:null,err:null}),ge(e).then((function(e){if("tooshort"===e)throw new Tt("query too short");return"nodata"===e?[]:e.split("\t")})).then((function(t){return{query:e,result:t,err:null}})).catch((function(t){return{query:e,result:null,err:t}})).then((function(t){l((function(n){return n.query===e?t:n}))}))};Object(a.useEffect)((function(){wt&&o(wt)}),[]);var i=Object(a.useCallback)((function(){if(e.current){var t=e.current.value;t?o(t):l({query:t,result:[],err:null})}}),[]),s=Object(a.useCallback)((function(e){e.preventDefault(),i()}),[i]),d=Object(a.useRef)(null),p=Object(a.useCallback)((function(e){d.current&&(d.current.textContent=e)}),[]),h=Object(u.c)(),v=Object(a.useCallback)((function(t,n){if(n.shiftKey){if(!e.current)return;e.current.value=t,o(t)}else h(pe.insertPart(t))}),[h]),f=Object(it.a)().t;return r.a.createElement("div",{className:"parts-search-area"},r.a.createElement("form",{className:"parts-search-box",onSubmit:s},r.a.createElement("input",{defaultValue:wt,list:"searchList",ref:e}),r.a.createElement("button",null,f("search")),r.a.createElement("datalist",{id:"searchList"},Ct.map((function(e,t){return r.a.createElement("option",{key:t,value:e})})))),r.a.createElement("div",{className:"parts-list-area"},c.err?c.err instanceof Tt?r.a.createElement("div",{className:"message"},f("search query too short")):r.a.createElement("div",{className:"message"},f("search error",{message:c.err})):c.result?0===c.result.length?r.a.createElement("div",{className:"message"},f("no search result")):r.a.createElement(Mt,{names:c.result,handleItemClick:v,handleItemMouseEnter:p}):r.a.createElement("div",{className:"message"},f("searching"))),r.a.createElement("div",{className:"parts-hover-name",ref:d},"\xa0"))},It=M.name||"sandbox",Dt="".concat(M.ssl?"https":"http","://").concat(M.host,"/wiki/").concat(encodeURIComponent(It),"?action=preview"),_t={visibility:"hidden",position:"absolute"},Pt=function(){var e=Object(u.d)((function(e){return e.exitEvent})),t=Object(a.useRef)(null);Object(a.useEffect)((function(){var n;e&&(null===(n=t.current)||void 0===n||n.submit())}),[e]);var n=Object(u.d)(mt);return r.a.createElement("form",{style:_t,ref:t,action:Dt,method:"post"},r.a.createElement("input",{type:"hidden",name:"page",value:It}),r.a.createElement("input",{type:"hidden",name:"action",value:"preview"}),r.a.createElement("input",{type:"hidden",name:"textbox",value:h(n)}),r.a.createElement("input",{type:"hidden",name:"related",value:M.related}),r.a.createElement("input",{type:"hidden",name:"summary",value:M.summary}),M.edittime&&r.a.createElement("input",{type:"hidden",name:"edittime",value:M.edittime}))},Rt=n(30),Lt=n.n(Rt);n(92);Lt.a.setAppElement("#root");var At=function(){var e=Object(u.d)((function(e){return e.showOptionModal})),t=Object(u.d)((function(e){return e.grid})),n=Object(u.d)((function(e){return e.shotai})),c=Object(u.d)((function(e){return e.showStrokeCenterLine})),l=Object(u.c)(),o=Object(a.useCallback)((function(){l(We.closeOptionModal())}),[l]),i=Object(a.useCallback)((function(e){l(We.setGridDisplay(e.currentTarget.checked))}),[l]),s=Object(a.useCallback)((function(e){l(We.setGridOriginX(e.currentTarget.valueAsNumber))}),[l]),d=Object(a.useCallback)((function(e){l(We.setGridOriginY(e.currentTarget.valueAsNumber))}),[l]),p=Object(a.useCallback)((function(e){l(We.setGridSpacingX(e.currentTarget.valueAsNumber))}),[l]),h=Object(a.useCallback)((function(e){l(We.setGridSpacingY(e.currentTarget.valueAsNumber))}),[l]),v=Object(a.useCallback)((function(e){l(We.setShotai(+e.currentTarget.value))}),[l]),f=Object(a.useCallback)((function(e){l(We.setStrokeCenterLineDisplay(e.currentTarget.checked))}),[l]),b=Object(it.a)(),m=b.t,g=b.i18n,y=Object(a.useCallback)((function(e){g.changeLanguage(e.currentTarget.value)}),[g]);return r.a.createElement(Lt.a,{isOpen:e,onRequestClose:o,shouldCloseOnEsc:!1,className:"modal-content"},r.a.createElement("fieldset",null,r.a.createElement("legend",null,m("grid option")),r.a.createElement("div",null,r.a.createElement("label",null,r.a.createElement("input",{type:"checkbox",checked:t.display,onChange:i}),m("enable grid"))),r.a.createElement("div",null,m("grid origin x")," ",r.a.createElement("input",{type:"number",value:t.originX,onChange:s,disabled:!t.display})," ",m("grid origin y")," ",r.a.createElement("input",{type:"number",value:t.originX,onChange:d,disabled:!t.display})),r.a.createElement("div",null,m("grid spacing x")," ",r.a.createElement("input",{type:"number",value:t.spacingX,onChange:p,disabled:!t.display})," ",m("grid spacing y")," ",r.a.createElement("input",{type:"number",value:t.spacingY,onChange:h,disabled:!t.display}))),r.a.createElement("div",null,m("glyph font style")," ",r.a.createElement("select",{value:n,onChange:v},r.a.createElement("option",{value:0},m("mincho style")),r.a.createElement("option",{value:1},m("gothic style")))),r.a.createElement("div",null,r.a.createElement("label",null,r.a.createElement("input",{type:"checkbox",checked:c,onChange:f}),m("show stroke center line"))),r.a.createElement("div",null,m("display language")," ",r.a.createElement("select",{value:g.language,onChange:y},r.a.createElement("option",{value:"ja"},"\u65e5\u672c\u8a9e"),r.a.createElement("option",{value:"en"},"English"),r.a.createElement("option",{value:"ko",disabled:!0},"\ud55c\uad6d\uc5b4"),r.a.createElement("option",{value:"zh-Hans",disabled:!0},"\u7b80\u4f53\u4e2d\u6587"),r.a.createElement("option",{value:"zh-Hant",disabled:!0},"\u7e41\u4f53\u4e2d\u6587"))),r.a.createElement("div",null,r.a.createElement("button",{onClick:o},m("close modal"))))},Gt=n(4);n(93);var Yt=function(){return function(){var e=Object(u.c)();Object(Gt.a)("ctrl+a, command+a",(function(t){e(I.selectAll()),t.preventDefault()}),{},[e]),Object(Gt.a)("ctrl+i, command+i",(function(t){e(I.selectDeselected()),t.preventDefault()}),{},[e]),Object(Gt.a)("ctrl+z, command+z",(function(t){e(Ve.undo()),t.preventDefault()}),{},[e]),Object(Gt.a)("ctrl+y, command+y, ctrl+shift+z, command+shift+z",(function(t){e(Ve.redo()),t.preventDefault()}),{},[e]),Object(Gt.a)("ctrl+x, command+x",(function(t){e(pe.cut()),t.preventDefault()}),{},[e]),Object(Gt.a)("ctrl+c, command+c",(function(t){e(pe.copy()),t.preventDefault()}),{},[e]),Object(Gt.a)("ctrl+v, command+v",(function(t){e(pe.paste()),t.preventDefault()}),{},[e]),Object(Gt.a)("del",(function(t){e(pe.delete()),t.preventDefault()}),{},[e]),Object(Gt.a)("esc",(function(){e(pe.escape())}),{},[e]),Object(Gt.a)("ctrl+h, left",(function(t){e(pe.moveSelected([-1,0])),t.preventDefault()}),{},[e]),Object(Gt.a)("ctrl+j, down",(function(t){e(pe.moveSelected([0,1])),t.preventDefault()}),{},[e]),Object(Gt.a)("ctrl+k, up",(function(t){e(pe.moveSelected([0,-1])),t.preventDefault()}),{},[e]),Object(Gt.a)("ctrl+l, right",(function(t){e(pe.moveSelected([1,0])),t.preventDefault()}),{},[e]),Object(Gt.a)("ctrl+shift+h, shift+left",(function(t){e(pe.moveSelected([-5,0])),t.preventDefault()}),{},[e]),Object(Gt.a)("ctrl+shift+j, shift+down",(function(t){e(pe.moveSelected([0,5])),t.preventDefault()}),{},[e]),Object(Gt.a)("ctrl+shift+k, shift+up",(function(t){e(pe.moveSelected([0,-5])),t.preventDefault()}),{},[e]),Object(Gt.a)("ctrl+shift+l, shift+right",(function(t){e(pe.moveSelected([5,0])),t.preventDefault()}),{},[e]),Object(Gt.a)("ctrl+s, command+s",(function(t){e(pe.finishEdit(t)),t.preventDefault()}),{},[e])}(),r.a.createElement("div",{className:"App"},r.a.createElement(ot,null),r.a.createElement(yt,null),r.a.createElement(Nt,null),r.a.createElement(Pt,null),r.a.createElement(At,null))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var Xt=n(31),Ht=n(18),zt={ja:{translation:n(45)},en:{translation:n(46)}},Ut="ja";switch(M.host.split(".")[0]){case"en":Ut="en";break;case"ko":Ut="ko";break;case"zhs":Ut="zh-Hans";break;case"zht":Ut="zh-Hant"}Xt.a.use(Ht.e).init({resources:zt,lng:Ut,fallbackLng:{"zh-Hans":["zh-Hant","ja"],"zh-Hant":["zh-Hans","ja"],default:["ja"]},returnObjects:!0,interpolation:{escapeValue:!1}});Xt.a,n(94);l.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(u.a,{store:Qe},r.a.createElement(Yt,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[49,1,2]]]);
//# sourceMappingURL=main.05cb7ac0.chunk.js.map