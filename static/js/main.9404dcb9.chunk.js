(this["webpackJsonpkage-editor"]=this["webpackJsonpkage-editor"]||[]).push([[0],{33:function(e){e.exports=JSON.parse('{"stroke type":"\u7dda\u7a2e","stroke type 1":"\u76f4\u7dda","stroke type 2":"\u66f2\u7dda","stroke type 3":"\u6298\u308c","stroke type 4":"\u4e59\u7dda","stroke type 6":"\u8907\u66f2\u7dda","stroke type 7":"\u7e26\u6255\u3044","part":"\u90e8\u54c1","alias of":"({{entity}} \u306e\u30a8\u30a4\u30ea\u30a2\u30b9)","stretch":"\u30b9\u30c8\u30ec\u30c3\u30c1:","select prev":"\u2190","swap with prev":"\u5165\u66ff\u2190","select next":"\u2192","swap with next":"\u2192\u5165\u66ff","undo":"\u5143\u306b\u623b\u3059","redo":"\u3084\u308a\u76f4\u3059","select all":"\u3059\u3079\u3066\u3092\u9078\u629e","invert selection":"\u9078\u629e\u7bc4\u56f2\u3092\u53cd\u8ee2","copy":"\u30b3\u30d4\u30fc","paste":"\u8cbc\u308a\u4ed8\u3051","cut":"\u5207\u308a\u53d6\u308a","start freehand":"\u624b\u66f8\u304d\u958b\u59cb","end freehand":"\u624b\u66f8\u304d\u7d42\u4e86","decompose":"\u90e8\u54c1\u5206\u89e3","options":"\u8868\u793a\u8a2d\u5b9a...","finish edit":"\u7de8\u96c6\u7d42\u4e86"}')},34:function(e,t,n){e.exports=n(67)},53:function(e,t,n){},54:function(e,t,n){},55:function(e,t,n){},56:function(e,t,n){},57:function(e,t,n){},58:function(e,t,n){},59:function(e,t,n){},65:function(e,t,n){},66:function(e,t,n){},67:function(e,t,n){"use strict";n.r(t);var a,r=n(0),c=n.n(r),o=n(15),l=n.n(o),i=n(3),s=n(8),u=n(4),d=n(1),p=n(2),h=n(27),f=n(17),v=n(28),b=n.n(v);!function(e){e[e.north=0]="north",e[e.south=1]="south",e[e.east=2]="east",e[e.west=3]="west",e[e.southeast=4]="southeast"}(a||(a={}));var m,g=b()("EDITOR"),O={selectSingle:g("SELECT_SINGLE"),selectAddSingle:g("SELECT_ADD_SINGLE"),selectRemoveSingle:g("SELECT_REMOVE_SINGLE"),selectNone:g("SELECT_NONE"),selectAll:g("SELECT_ALL"),selectDeselected:g("SELECT_TOGGLE_ALL"),selectPrev:g("SELECT_PREV"),selectNext:g("SELECT_NEXT"),startAreaSelect:g("AREA_SELECT_START"),startSelectionDrag:g("SELECTION_DRAG_START"),startPointDrag:g("MOVE_POINT_START"),startResize:g("RESIZE_START"),mouseMove:g("MOUSE_MOVE"),mouseUp:g("MOUSE_UP"),updateCTMInv:g("UPDATE_CTMINV"),loadedBuhin:g("LOAD_BUHIN_DATA"),loadedStretchParam:g("LOAD_STRETCH_PARAM"),swapWithPrev:g("SWAP_WITH_PREV"),swapWithNext:g("SWAP_WITH_NEXT"),undo:g("UNDO"),redo:g("REDO"),paste:g("PASTE"),copy:g("COPY_SELECTION"),cut:g("CUT_SELECTION"),decomposeSelected:g("DECOMPOSE_SELECTION"),toggleFreehand:g("TOGGLE_FREEHAND_MODE"),openOptionModal:g("OPEN_OPTION_MODAL"),closeOptionModal:g("CLOSE_OPTION_MODAL")},y=function(e){switch(e){case 0:case 1:case 9:return 7;case 2:case 3:case 4:return 9;case 6:case 7:case 99:return 11;default:return 0}},j=function(e){var t=e.value.slice();return 99===t[0]&&(t[7]=e.partName||""),t.join(":")},E=function(e){return e.split(/[$\r\n]+/).map((function(e){return function(e){for(var t=e.split(":"),n=+t[0],a=y(n),r=[],c=0;c<a;c++)r.push(Math.floor(+t[c]||0));return 99===r[0]?{value:r,partName:t[7]||""}:{value:r}}(e)})).filter((function(e){return 0!==(t=e).value.length&&(0!==t.value[0]||97===t.value[1]||98===t.value[1]||99===t.value[1]);var t}))},M=n(6),w=function(e){var t=e.map((function(e){return Object(p.a)(e,1)[0]})),n=e.map((function(e){return Object(p.a)(e,2)[1]}));return[Math.min.apply(Math,Object(u.a)(t)),Math.min.apply(Math,Object(u.a)(n)),Math.max.apply(Math,Object(u.a)(t)),Math.max.apply(Math,Object(u.a)(n))]},x=function(e){switch(e.value[0]){case 99:return w([[e.value[3],e.value[4]],[e.value[5],e.value[6]]]);case 0:case 1:case 2:case 3:case 4:case 6:case 7:case 9:for(var t=[],n=3;n+2<=e.value.length;n+=2)t.push([e.value[n],e.value[n+1]]);return w(t);default:return w([])}},S=function(e,t){var n=Object(p.a)(e,4),a=n[0],r=n[1],c=n[2],o=n[3],l=Object(p.a)(t,4),i=l[0],s=l[1],u=l[2],d=l[3];return[Math.min(a,i),Math.min(r,s),Math.max(c,u),Math.max(o,d)]},D=Object(M.a)((function(e){return e.map(x).reduce(S,w([]))}),(function(e,t){var n=Object(p.a)(e,1)[0],a=Object(p.a)(t,1)[0];return n.length===a.length&&n.every((function(e,t){return e===a[t]}))})),N=n(7),k=[[{position:"start",strokeTypes:[1],shapeTypes:[2]},{position:"start",strokeTypes:[1,2,3,4,6,7],shapeTypes:[12]}],[{position:"start",strokeTypes:[1],shapeTypes:[2]},{position:"end",strokeTypes:[1],shapeTypes:[13,313,413]}],[{position:"end",strokeTypes:[1],shapeTypes:[2]},{position:"start",strokeTypes:[1,2,3,4,6,7],shapeTypes:[22]}],[{position:"end",strokeTypes:[1],shapeTypes:[2]},{position:"end",strokeTypes:[1],shapeTypes:[23,24]}]],C=function(e,t){return e.position===t.position&&e.strokeTypes.includes(t.strokeType)&&e.shapeTypes.includes(t.shapeType)},I=function(e){var t=[];switch(e.value[0]){case 1:case 2:case 3:case 4:case 6:case 7:t.push({position:"start",strokeType:e.value[0],shapeType:e.value[1],coord:[e.value[3],e.value[4]],pointIndex:0});var n=(y(e.value[0])-3)/2-1;t.push({position:"end",strokeType:e.value[0],shapeType:e.value[2],coord:[e.value[3+2*n],e.value[3+2*n+1]],pointIndex:n})}return t},T=Object(M.a)((function(e,t){var n,a=[],r=Object(N.a)(t);try{for(r.s();!(n=r.n()).done;){var c,o=n.value,l=o.lineIndex,i=o.pointIndex,s=Object(N.a)(I(e[l]));try{for(s.s();!(c=s.n()).done;){var u=c.value;u.pointIndex===i&&a.push(u)}}catch(h){s.e(h)}finally{s.f()}}}catch(h){r.e(h)}finally{r.f()}var d=[];return e.forEach((function(e,t){var n,r=Object(N.a)(I(e));try{var c=function(){var e=n.value;a.some((function(t){return a=e,(n=t).coord[0]===a.coord[0]&&n.coord[1]===a.coord[1]&&k.some((function(e){var t=Object(p.a)(e,2),r=t[0],c=t[1];return C(r,n)&&C(c,a)||C(c,n)&&C(r,a)}));var n,a}))&&d.push({lineIndex:t,pointIndex:e.pointIndex})};for(r.s();!(n=r.n()).done;)c()}catch(h){r.e(h)}finally{r.f()}})),d}),(function(e,t){var n=Object(p.a)(e,2),a=n[0],r=n[1],c=Object(p.a)(t,2),o=c[0],l=c[1];return a===o&&r.length===l.length&&r.every((function(e,t){return e.lineIndex===l[t].lineIndex&&e.pointIndex===l[t].pointIndex}))})),P=Object(M.a)((function(e,t){var n,a=[],r=Object(N.a)(t);try{for(r.s();!(n=r.n()).done;){var c=n.value,o=e[c];a.push({lineIndex:c,pointIndex:0}),a.push({lineIndex:c,pointIndex:(y(o.value[0])-3)/2-1})}}catch(l){r.e(l)}finally{r.f()}return T(e,a).filter((function(e){var n=e.lineIndex;return!t.includes(n)}))})),R=function(e,t,n){switch(e.value[0]){case 99:var a=e.value.slice();return a[3]=t(a[3]),a[4]=n(a[4]),a[5]=t(a[5]),a[6]=n(a[6]),{value:a,partName:e.partName};case 0:case 1:case 2:case 3:case 4:case 6:case 7:case 9:for(var r=e.value.slice(),c=3;c+2<=r.length;c+=2)r[c]=t(r[c]),r[c+1]=n(r[c+1]);return{value:r};default:return e}},_=function(e,t,n,a){if(0===t.length)return e;var r,c=e.slice(),o=Object(N.a)(t);try{for(o.s();!(r=o.n()).done;){var l=r.value,i=l.lineIndex,s=l.pointIndex,u=c[i],p=u.value.slice();p[3+2*s]=n(p[3+2*s]),p[3+2*s+1]=a(p[3+2*s+1]),c[i]=Object(d.a)(Object(d.a)({},u),{},{value:p})}}catch(h){o.e(h)}finally{o.f()}return c},A=function(e,t,n,a){var r=P(e,t),c=function(e){return Math.round(e+n)},o=function(e){return Math.round(e+a)};return e=e.map((function(e,n){return t.includes(n)?R(e,c,o):e})),e=_(e,r,c,o)},L=function(e,t,n,a,r){if(0===t.length)return e;var c=t[0],o={lineIndex:c,pointIndex:n},l=T(e,[o]).filter((function(e){return e.lineIndex!==c}));l.push(o);return e=_(e,l,(function(e){return Math.round(e+a)}),(function(e){return Math.round(e+r)}))},z=function(e,t,n,a){return e.map((function(e,r){return t.includes(r)?function(e,t,n){var a=Object(p.a)(t,4),r=a[0],c=a[1],o=a[2],l=a[3],i=Object(p.a)(n,4),s=i[0],u=i[1],d=i[2],h=i[3];return R(e,(function(e){return Math.round(s+(e-r)*(d-s)/(o-r))}),(function(e){return Math.round(u+(e-c)*(h-u)/(l-c))}))}(e,n,a):e}))},W=n(29),X=n(5),U=n.n(X),Y=n(13),G=function(){var e=Object(Y.a)(U.a.mark((function e(t){var n;return U.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://asia-northeast1-ku6goma.cloudfunctions.net/gwproxy"+t);case 2:if((n=e.sent).ok){e.next=5;break}throw new Error("API error occurred");case 5:return e.t0=URLSearchParams,e.next=8,n.text();case 8:return e.t1=e.sent,e.abrupt("return",new e.t0(e.t1));case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),B=function(){var e=Object(Y.a)(U.a.mark((function e(t){var n;return U.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,G("/get_source.cgi?name=".concat(encodeURIComponent(t)));case 2:return n=e.sent,e.abrupt("return",n.get("data"));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),F=new W.Kage,$=new Set,V=Object(M.a)((function(e,t){var n=e.map(j);return F.kBuhin.search=function(e){var n=t.get(e);return"undefined"===typeof n?(function(e){$.has(e)||($.add(e),B(e).then((function(t){if("string"!==typeof t)throw new Error("failed to get buhin source of ".concat(e));var n=/^0:1:0:(-?\d+):(-?\d+):(-?\d+):(-?\d+)(?=$|\$)/.exec(t);if(n){var a=[+n[1]||0,+n[2]||0,+n[3]||0,+n[4]||0];re.dispatch(O.loadedStretchParam([e,a]))}re.dispatch(O.loadedBuhin([e,t])),$.delete(e)})).catch((function(e){return console.error(e)})))}(e),""):n},F.makeGlyphSeparated(n)})),H=function(e){return 99!==e.value[0]?null:[e.value[9],e.value[10],e.value[1],e.value[2]]},K=function(e){var t=Object(p.a)(e,4),n=t[0],a=t[1],r=t[2];return r<=100&&(r+=200,n=a=0),[n,a,r,t[3]]},J=function(e,t){var n=Object(p.a)(e,4),a=n[0],r=n[1],c=n[2],o=n[3];if(a===c&&r===o)return 0;var l,i=K(t),s=Object(p.a)(i,4),u=s[0],d=s[1],h=s[2],f=s[3];return u===h-200&&d===f?0:(l=Math.round(Math.abs(a-c)>Math.abs(r-o)?(h-100-a)/(c-a)*20:(f+100-r)/(o-r)*20),Math.max(-10,Math.min(10,l))||0)},Z=function(e,t){if(99!==e.value[0])return[e];var n=t.get(e.partName);if(!n)return[e];var a=!1;F.kBuhin.search=function(e){var n=t.get(e);return"string"!==typeof n?(a=!0,""):n};var r=E(n),c=F.getEachStrokes(function(e){return e.map((function(e){return j(e)})).join("$")}(r)),o=F.getBox(c);if(a)return[e];var l=e.value[3],i=e.value[4],s=e.value[5],u=e.value[6],d=K(H(e)),h=Object(p.a)(d,4),f=h[0],v=h[1],b=h[2],m=h[3],g=!(f===b-200&&v===m);return r.map((function(e){var t=R(e,(function(e){var t=g?F.stretch(b-200,f,e,o.minX,o.maxX):e;return Math.round(t/200*(s-l)+l)}),(function(e){var t=g?F.stretch(m,v,e,o.minY,o.maxY):e;return Math.round(t/200*(u-i)+i)}));if(!g||99!==t.value[0])return t;var n=K(H(t)),a=Object(p.a)(n,4),r=a[0],c=a[1],d=a[2],h=a[3];if(r!==d-200||c!==h)return t;var O=t.value[3],y=t.value[4],j=t.value[5],E=t.value[6];if(O===j||y===E)return t;var M=function(e){return(e-O)/(j-O)*200},w=function(e){return(e-y)/(E-y)*200};return function(e,t){if(99!==e.value[0])return e;var n=Object(p.a)(t,4),a=n[0],r=n[1],c=n[2],o=n[3],l=e.value.slice();return l[9]=a,l[10]=r,l[1]=c,l[2]=o,{value:l,partName:e.partName}}(t,[M(r+100),w(c+100),M(d-100)+100,w(h+100)])}))},q=new URLSearchParams(window.location.hash.slice(1)),Q=function(e,t,n,r,c){if(1===t.length){var o=e[t[0]];switch(o.value[0]){case 0:case 9:case 99:var l=o.value.slice();switch(n){case a.north:l[4]+=c;break;case a.west:l[3]+=r;break;case a.south:l[6]+=c;break;case a.east:l[5]+=r;break;case a.southeast:l[5]+=r,l[6]+=c}var i=99===o.value[0]?{value:l,partName:o.partName}:{value:l};return e.map((function(e,n){return n===t[0]?i:e}))}}var s=D(t.map((function(t){return e[t]}))),u=s.slice();switch(n){case a.north:u[1]=Math.min(u[1]+c,u[3]-20);break;case a.west:u[0]=Math.min(u[0]+r,u[2]-20);break;case a.south:u[3]=Math.max(u[3]+c,u[1]+20);break;case a.east:u[2]=Math.max(u[2]+r,u[0]+20);break;case a.southeast:u[2]=Math.max(u[2]+r,u[0]+20),u[3]=Math.max(u[3]+c,u[1]+20)}return z(e,t,s,u)},ee=function(e){var t=e.glyph;if(e.dragSelection){var n=Object(p.a)(e.dragSelection,4),a=n[0],r=n[1],c=n[2]-a,o=n[3]-r;t=A(e.glyph,e.selection,c,o)}else if(e.dragPoint){var l=Object(p.a)(e.dragPoint,2),i=l[0],s=Object(p.a)(l[1],4),u=s[0],d=s[1],h=s[2]-u,f=s[3]-d;t=L(e.glyph,e.selection,i,h,f)}else if(e.resizeSelection){var v=Object(p.a)(e.resizeSelection,2),b=v[0],m=Object(p.a)(v[1],4),g=m[0],O=m[1],y=m[2]-g,j=m[3]-O;t=Q(e.glyph,e.selection,b,y,j)}return t},te={glyph:E(q.get("data")||""),selection:[],areaSelectRect:null,dragSelection:null,dragPoint:null,resizeSelection:null,ctmInv:null,buhinMap:new Map,stretchParamMap:new Map,freehandMode:!1,showOptionModal:!1,clipboard:[]},ne=Object(h.reducerWithInitialState)(te).case(O.selectSingle,(function(e,t){return Object(d.a)(Object(d.a)({},e),{},{selection:[t]})})).case(O.selectAddSingle,(function(e,t){return Object(d.a)(Object(d.a)({},e),{},{selection:e.selection.includes(t)?e.selection:e.selection.concat([t])})})).case(O.selectRemoveSingle,(function(e,t){return Object(d.a)(Object(d.a)({},e),{},{selection:e.selection.filter((function(e){return t!==e}))})})).case(O.selectAll,(function(e){return Object(d.a)(Object(d.a)({},e),{},{selection:e.glyph.map((function(e,t){return t}))})})).case(O.selectDeselected,(function(e){return Object(d.a)(Object(d.a)({},e),{},{selection:e.glyph.map((function(e,t){return t})).filter((function(t){return!e.selection.includes(t)}))})})).case(O.selectNone,(function(e){return Object(d.a)(Object(d.a)({},e),{},{selection:[]})})).case(O.selectPrev,(function(e){if(0===e.glyph.length)return Object(d.a)(Object(d.a)({},e),{},{selection:[]});var t=0===e.selection.length?0:Math.min.apply(Math,Object(u.a)(e.selection));return Object(d.a)(Object(d.a)({},e),{},{selection:[(t-1+e.glyph.length)%e.glyph.length]})})).case(O.selectNext,(function(e){if(0===e.glyph.length)return Object(d.a)(Object(d.a)({},e),{},{selection:[]});var t=0===e.selection.length?-1:Math.max.apply(Math,Object(u.a)(e.selection));return Object(d.a)(Object(d.a)({},e),{},{selection:[(t+1+e.glyph.length)%e.glyph.length]})})).case(O.startAreaSelect,(function(e,t){if(!e.ctmInv)return e;var n=e.ctmInv(t.clientX,t.clientY),a=Object(p.a)(n,2),r=a[0],c=a[1];return Object(d.a)(Object(d.a)({},e),{},{areaSelectRect:[r,c,r,c]})})).case(O.startSelectionDrag,(function(e,t){if(!e.ctmInv)return e;var n=e.ctmInv(t.clientX,t.clientY),a=Object(p.a)(n,2),r=a[0],c=a[1];return Object(d.a)(Object(d.a)({},e),{},{dragSelection:[r,c,r,c]})})).case(O.startPointDrag,(function(e,t){var n=Object(p.a)(t,2),a=n[0],r=n[1];if(!e.ctmInv)return e;var c=e.ctmInv(a.clientX,a.clientY),o=Object(p.a)(c,2),l=o[0],i=o[1];return Object(d.a)(Object(d.a)({},e),{},{dragPoint:[r,[l,i,l,i]]})})).case(O.startResize,(function(e,t){var n=Object(p.a)(t,2),a=n[0],r=n[1];if(!e.ctmInv)return e;var c=e.ctmInv(a.clientX,a.clientY),o=Object(p.a)(c,2),l=o[0],i=o[1];return Object(d.a)(Object(d.a)({},e),{},{resizeSelection:[r,[l,i,l,i]]})})).case(O.mouseMove,(function(e,t){if(!e.ctmInv)return e;if(e.areaSelectRect){var n=Object(p.a)(e.areaSelectRect,2),a=n[0],r=n[1],c=e.ctmInv(t.clientX,t.clientY),o=Object(p.a)(c,2),l=o[0],i=o[1];return Object(d.a)(Object(d.a)({},e),{},{areaSelectRect:[a,r,l,i]})}if(e.dragSelection){var s=Object(p.a)(e.dragSelection,2),u=s[0],h=s[1],f=e.ctmInv(t.clientX,t.clientY),v=Object(p.a)(f,2),b=v[0],m=v[1];return Object(d.a)(Object(d.a)({},e),{},{dragSelection:[u,h,b,m]})}if(e.dragPoint){var g=Object(p.a)(e.dragPoint,2),O=g[0],y=Object(p.a)(g[1],2),j=y[0],E=y[1],M=e.ctmInv(t.clientX,t.clientY),w=Object(p.a)(M,2),x=w[0],S=w[1];return Object(d.a)(Object(d.a)({},e),{},{dragPoint:[O,[j,E,x,S]]})}if(e.resizeSelection){var D=Object(p.a)(e.resizeSelection,2),N=D[0],k=Object(p.a)(D[1],2),C=k[0],I=k[1],T=e.ctmInv(t.clientX,t.clientY),P=Object(p.a)(T,2),R=P[0],_=P[1];return Object(d.a)(Object(d.a)({},e),{},{resizeSelection:[N,[C,I,R,_]]})}return e})).case(O.mouseUp,(function(e,t){if(!e.ctmInv)return e;if(e.areaSelectRect){var n=Object(p.a)(e.areaSelectRect,2),a=n[0],r=n[1],c=e.ctmInv(t.clientX,t.clientY),o=Object(p.a)(c,2),l=o[0],i=o[1],s=function(e,t,n,a,r,c){for(var o=V(e,t),l=[],i=[[n,a],[n,c],[r,c],[r,a],[n,a]],s=0;s<o.length;s++){o[s].array.some((function(e){var t=e.array.map((function(e){return[e.x,e.y]}));return t.push(t[0]),Object(f.a)(i,t)||Object(f.a)(t,i)||Object(f.b)(i,t)}))&&l.push(s)}return l}(e.glyph,e.buhinMap,a,r,l,i),u=Array.from(new Set(e.selection.concat(s)));return Object(d.a)(Object(d.a)({},e),{},{selection:u,areaSelectRect:null})}if(e.dragSelection){var h=Object(p.a)(e.dragSelection,2),v=h[0],b=h[1],m=e.ctmInv(t.clientX,t.clientY),g=Object(p.a)(m,2),O=g[0],y=g[1],j=A(e.glyph,e.selection,O-v,y-b);return Object(d.a)(Object(d.a)({},e),{},{glyph:j,dragSelection:null})}if(e.dragPoint){var E=Object(p.a)(e.dragPoint,2),M=E[0],w=Object(p.a)(E[1],2),x=w[0],S=w[1],D=e.ctmInv(t.clientX,t.clientY),N=Object(p.a)(D,2),k=N[0],C=N[1],I=L(e.glyph,e.selection,M,k-x,C-S);return Object(d.a)(Object(d.a)({},e),{},{glyph:I,dragPoint:null})}if(e.resizeSelection){var T=Object(p.a)(e.resizeSelection,2),P=T[0],R=Object(p.a)(T[1],2),_=R[0],z=R[1],W=e.ctmInv(t.clientX,t.clientY),X=Object(p.a)(W,2),U=X[0],Y=X[1],G=Q(e.glyph,e.selection,P,U-_,Y-z);return Object(d.a)(Object(d.a)({},e),{},{glyph:G,resizeSelection:null})}return e})).case(O.updateCTMInv,(function(e,t){return Object(d.a)(Object(d.a)({},e),{},{ctmInv:t})})).case(O.loadedBuhin,(function(e,t){var n=Object(p.a)(t,2),a=n[0],r=n[1],c=new Map(e.buhinMap);return c.set(a,r),Object(d.a)(Object(d.a)({},e),{},{buhinMap:c})})).case(O.loadedStretchParam,(function(e,t){var n=Object(p.a)(t,2),a=n[0],r=n[1],c=new Map(e.stretchParamMap);return c.set(a,r),Object(d.a)(Object(d.a)({},e),{},{stretchParamMap:c})})).case(O.swapWithPrev,(function(e){if(1!==e.selection.length)return e;var t=e.selection[0];if(0===t)return e;var n=e.glyph.slice();return n[t-1]=e.glyph[t],n[t]=e.glyph[t-1],Object(d.a)(Object(d.a)({},e),{},{glyph:n,selection:[t-1]})})).case(O.swapWithNext,(function(e){if(1!==e.selection.length)return e;var t=e.selection[0];if(t===e.glyph.length-1)return e;var n=e.glyph.slice();return n[t+1]=e.glyph[t],n[t]=e.glyph[t+1],Object(d.a)(Object(d.a)({},e),{},{glyph:n,selection:[t+1]})})).case(O.undo,(function(e){return e})).case(O.redo,(function(e){return e})).case(O.paste,(function(e){return Object(d.a)(Object(d.a)({},e),{},{glyph:e.glyph.concat(e.clipboard),selection:e.clipboard.map((function(t,n){return e.glyph.length+n}))})})).case(O.copy,(function(e){var t=e.selection.map((function(t){return e.glyph[t]})),n=D(t),a=Object(p.a)(n,2),r=a[0],c=a[1],o=function(e){return 230+e-r},l=function(e){return 20+e-c};return Object(d.a)(Object(d.a)({},e),{},{clipboard:e.selection.map((function(t){return R(e.glyph[t],o,l)}))})})).case(O.cut,(function(e){return Object(d.a)(Object(d.a)({},e),{},{glyph:e.glyph.filter((function(t,n){return!e.selection.includes(n)})),clipboard:e.selection.map((function(t){return e.glyph[t]})),selection:[]})})).case(O.decomposeSelected,(function(e){var t=[],n=[];return e.glyph.forEach((function(a,r){if(e.selection.includes(r)){var c=Z(a,e.buhinMap);n=n.concat(c.map((function(e,n){return t.length+n}))),t=t.concat(c)}else t.push(a)})),Object(d.a)(Object(d.a)({},e),{},{glyph:t,selection:n})})).case(O.toggleFreehand,(function(e){return Object(d.a)(Object(d.a)({},e),{},{selection:e.freehandMode?e.selection:[],freehandMode:!e.freehandMode})})).case(O.openOptionModal,(function(e){return Object(d.a)(Object(d.a)({},e),{},{showOptionModal:!0})})).case(O.closeOptionModal,(function(e){return Object(d.a)(Object(d.a)({},e),{},{showOptionModal:!1})})),ae=Object(s.b)({editor:ne}),re=Object(s.c)(ae),ce=(n(53),function(e){return c.a.createElement(c.a.Fragment,null,e.polygons.array.map((function(e,t){return c.a.createElement("polygon",{key:t,points:e.array.map((function(e){var t=e.x,n=e.y;return"".concat(t,",").concat(n," ")})).join("")})})))}),oe=(n(54),function(e){var t=V(e.glyph,e.buhinMap),n=e.selection,a=t.map((function(e,t){return t})).filter((function(e){return!n.includes(e)}));return c.a.createElement(c.a.Fragment,null,c.a.createElement("g",{className:"strokes-deselected"},a.map((function(n){return c.a.createElement("g",{key:n,onMouseDown:function(t){var a;return null===(a=e.handleMouseDownDeselectedStroke)||void 0===a?void 0:a.call(e,t,n)}},c.a.createElement(ce,{polygons:t[n]}))}))),c.a.createElement("g",{className:"strokes-selected"},n.map((function(n){return c.a.createElement("g",{key:n,onMouseDown:function(t){var a;return null===(a=e.handleMouseDownSelectedStroke)||void 0===a?void 0:a.call(e,t,n)}},c.a.createElement(ce,{polygons:t[n]}))}))))}),le=(n(55),function(e){if(!e.rect)return null;var t=Object(p.a)(e.rect,4),n=t[0],a=t[1],r=t[2],o=t[3];if(n>r){var l=n;n=r,r=l}if(a>o){var i=a;a=o,o=i}return c.a.createElement("rect",{className:"areaselect-rect",x:n,y:a,width:r-n,height:o-a})}),ie=n(10),se=(n(56),function(e){return c.a.createElement("rect",{x:e.x-4,y:e.y-4,width:8,height:8,className:"controlpoint-rect ".concat(e.className||""),onMouseDown:e.handleMouseDown})}),ue=(n(57),function(e){return c.a.createElement(c.a.Fragment,null,e.rectControl&&c.a.createElement(c.a.Fragment,null,c.a.createElement("rect",{className:"selection-rect",x:e.rectControl.coords[0],y:e.rectControl.coords[1],width:e.rectControl.coords[2]-e.rectControl.coords[0],height:e.rectControl.coords[3]-e.rectControl.coords[1]}),c.a.createElement(se,{x:(e.rectControl.coords[0]+e.rectControl.coords[2])/2,y:e.rectControl.coords[1],className:"north",handleMouseDown:function(t){return e.handleMouseDownRectControl(t,a.north)}}),c.a.createElement(se,{x:e.rectControl.coords[0],y:(e.rectControl.coords[1]+e.rectControl.coords[3])/2,className:"west",handleMouseDown:function(t){return e.handleMouseDownRectControl(t,a.west)}}),c.a.createElement(se,{x:(e.rectControl.coords[0]+e.rectControl.coords[2])/2,y:e.rectControl.coords[3],className:"south",handleMouseDown:function(t){return e.handleMouseDownRectControl(t,a.south)}}),c.a.createElement(se,{x:e.rectControl.coords[2],y:(e.rectControl.coords[1]+e.rectControl.coords[3])/2,className:"east",handleMouseDown:function(t){return e.handleMouseDownRectControl(t,a.east)}}),c.a.createElement(se,{x:e.rectControl.coords[2],y:e.rectControl.coords[3],className:"southeast",handleMouseDown:function(t){return e.handleMouseDownRectControl(t,a.southeast)}})),e.pointControl.map((function(t,n){var a=t.x,r=t.y,o=t.className;return c.a.createElement(se,{key:n,x:a,y:r,className:o,handleMouseDown:function(t){return e.handleMouseDownPointControl(t,n)}})})))});!function(e){e[e.none=0]="none",e[e.online=1]="online",e[e.match=2]="match"}(m||(m={}));var de,pe=function(e,t){var n=e[t.lineIndex],a=(y(n.value[0])-3)/2-1;if(0!==t.pointIndex&&t.pointIndex!==a)return m.none;for(var r=n.value[3+2*t.pointIndex],c=n.value[3+2*t.pointIndex+1],o=function(e,t,n,a){return e===n&&e===r&&t<=c&&c<=a||t===a&&t===c&&e<=r&&r<=n},l=m.none,i=0;i<e.length;i++)if(t.lineIndex!==i){var s=e[i];if(![0,9,99].includes(s.value[0])){if(s.value[3]===r&&s.value[4]===c)return m.match;var u=(y(s.value[0])-3)/2-1;if(s.value[3+2*u]===r&&s.value[3+2*u+1]===c)return m.match;switch(s.value[0]){case 3:case 4:(o(s.value[3],s.value[4],s.value[5],s.value[6])||o(s.value[5],s.value[6],s.value[7],s.value[8]))&&(l=m.online);break;case 1:case 7:o(s.value[3],s.value[4],s.value[5],s.value[6])&&(l=m.online)}}}return l},he=Object(ie.a)([function(e){return ee(e.editor)},function(e){return e.editor.selection}],(function(e,t){if(0===t.length)return{rectControl:null,pointControl:[]};if(t.length>1){var n=t.map((function(t){return e[t]}));return{rectControl:{multiSelect:!0,coords:D(n)},pointControl:[]}}var a=e[t[0]];switch(a.value[0]){case 0:case 9:case 99:return{rectControl:{multiSelect:!1,coords:[a.value[3],a.value[4],a.value[5],a.value[6]]},pointControl:[]};case 1:case 2:case 3:case 4:case 6:case 7:for(var r=[],c=3;c+2<=a.value.length;c+=2){var o=pe(e,{lineIndex:t[0],pointIndex:(c-3)/2}),l="";o===m.match?l="match":o===m.online&&(l="online"),r.push({x:a.value[c],y:a.value[c+1],className:l})}return{rectControl:null,pointControl:r};default:return{rectControl:null,pointControl:[]}}})),fe=Object(i.b)(he,(function(e){return{handleMouseDownRectControl:function(t,n){e(O.startResize([t,n])),t.stopPropagation()},handleMouseDownPointControl:function(t,n){e(O.startPointDrag([t,n])),t.stopPropagation()}}}))(ue),ve=(n(58),function(e){var t=e.handleMouseMove,n=e.handleMouseUp;return Object(r.useEffect)((function(){return document.addEventListener("mousemove",t),document.addEventListener("mouseup",n),function(){document.removeEventListener("mousemove",t),document.removeEventListener("mouseup",n)}}),[t,n]),c.a.createElement("div",{className:"glyph-area"},c.a.createElement("svg",{width:"100%",height:"100%",viewBox:"-20 -20 500 240",onMouseDownCapture:e.handleMouseDownCapture,onMouseDown:e.handleMouseDownBackground},c.a.createElement("rect",{x:"0",y:"0",width:"200",height:"200",className:"glyph-boundary"}),c.a.createElement("rect",{x:"12",y:"12",width:"176",height:"176",className:"glyph-guide"}),c.a.createElement(oe,{glyph:e.glyph,buhinMap:e.buhinMap,selection:e.selection,handleMouseDownDeselectedStroke:e.handleMouseDownDeselectedStroke,handleMouseDownSelectedStroke:e.handleMouseDownSelectedStroke}),c.a.createElement(fe,null),c.a.createElement(le,{rect:e.areaSelectRect})))}),be=Object(i.b)((function(e){return Object(d.a)(Object(d.a)({},e.editor),{},{glyph:ee(e.editor)})}),(function(e){return{handleMouseDownCapture:function(t){var n=t.currentTarget.getScreenCTM();if(n){var a=t.currentTarget.createSVGPoint(),r=n.inverse();e(O.updateCTMInv((function(e,t){a.x=e,a.y=t;var n=a.matrixTransform(r);return[n.x,n.y]})))}},handleMouseDownBackground:function(t){t.shiftKey||t.ctrlKey||e(O.selectNone()),e(O.startAreaSelect(t))},handleMouseDownDeselectedStroke:function(t,n){t.shiftKey||t.ctrlKey?e(O.selectAddSingle(n)):e(O.selectSingle(n)),e(O.startSelectionDrag(t)),t.stopPropagation()},handleMouseDownSelectedStroke:function(t,n){(t.shiftKey||t.ctrlKey)&&e(O.selectRemoveSingle(n)),e(O.startSelectionDrag(t)),t.stopPropagation()},handleMouseMove:function(t){e(O.mouseMove(t))},handleMouseUp:function(t){e(O.mouseUp(t))}}}))(ve),me=n(68),ge=(n(59),function(e){var t=Object(me.a)().t;return c.a.createElement("div",{className:"select-control"},c.a.createElement("div",{className:"selected-info"},e.infoType===de.stroke&&c.a.createElement("div",null,t("stroke type"),c.a.createElement("select",{value:e.selectedGlyphLine.value[0]},[1,2,3,4,6,7].map((function(e){return c.a.createElement("option",{key:e,value:e},t("stroke type ".concat(e)))})))),e.infoType===de.part&&c.a.createElement("div",null,t("part")," ",c.a.createElement("strong",null,e.selectedGlyphLine.partName)," ",e.entityName&&t("alias of",{entity:e.entityName})),c.a.createElement("div",null,e.summary),e.infoType===de.part&&"number"===typeof e.stretchCoeff&&c.a.createElement("div",null,t("stretch")," ",c.a.createElement("input",{type:"range",min:-10,max:10,value:e.stretchCoeff})," ",e.stretchCoeff)),c.a.createElement("div",{className:"selection-control"},c.a.createElement("button",{disabled:e.swapPrevDisabled,onClick:e.swapWithPrev},t("swap with prev")),c.a.createElement("button",{className:"select-prevnext-button",disabled:e.selectPrevDisabled,onClick:e.selectPrev},t("select prev")),c.a.createElement("div",{className:"selection-num"},e.selectIndexString),c.a.createElement("button",{className:"select-prevnext-button",disabled:e.selectNextDisabled,onClick:e.selectNext},t("select next")),c.a.createElement("button",{disabled:e.swapNextDisabled,onClick:e.swapWithNext},t("swap with next"))))});!function(e){e[e.stroke=0]="stroke",e[e.part=1]="part",e[e.other=2]="other"}(de||(de={}));var Oe=Object(ie.a)([function(e){return e.editor.glyph},function(e){return e.editor.buhinMap},function(e){return e.editor.stretchParamMap},function(e){return e.editor.selection}],(function(e,t,n,a){if(0===a.length)return{infoType:de.other,summary:"",selectIndexString:"- / ".concat(e.length||"-"),swapPrevDisabled:!0,swapNextDisabled:!0,selectPrevDisabled:0===e.length,selectNextDisabled:0===e.length};if(a.length>1){var r=a.map((function(e){return e+1})).sort((function(e,t){return e-t})).join(",");return{infoType:de.other,summary:"",selectIndexString:"".concat(r," / ").concat(e.length||"-"),swapPrevDisabled:!0,swapNextDisabled:!0,selectPrevDisabled:0===e.length,selectNextDisabled:0===e.length}}var c="".concat(a[0]+1," / ").concat(e.length||"-"),o=0===a[0],l=a[0]===e.length-1,i=e[a[0]],s=function(){for(var e=[],t=3;t+2<=i.value.length;t+=2)e.push("(".concat(i.value[t],",").concat(i.value[t+1],")"));return e.join(" \u2192 ")};switch(i.value[0]){case 99:var u=t.get(i.partName),d=void 0;if(u){var p=/^(?:0:1:0:[^$]+\$)?99:0:0:0:0:200:200:([^$]+)$/.exec(u);p&&(d=p[1])}var h=n.get(i.partName),f=h?J(h,H(i)):void 0;return{infoType:de.part,selectedGlyphLine:i,entityName:d,stretchCoeff:f,summary:"(".concat(i.value[3],",").concat(i.value[4],") \u2192 (").concat(i.value[5],",").concat(i.value[6],")"),selectIndexString:c,swapPrevDisabled:o,swapNextDisabled:l,selectPrevDisabled:!1,selectNextDisabled:!1};case 1:case 2:case 3:case 4:case 6:case 7:return{infoType:de.stroke,selectedGlyphLine:i,summary:s(),selectIndexString:c,swapPrevDisabled:o,swapNextDisabled:l,selectPrevDisabled:!1,selectNextDisabled:!1};case 0:case 9:return{infoType:de.other,summary:s(),selectIndexString:c,swapPrevDisabled:o,swapNextDisabled:l,selectPrevDisabled:!1,selectNextDisabled:!1};default:return{infoType:de.other,summary:"",selectIndexString:c,swapPrevDisabled:o,swapNextDisabled:l,selectPrevDisabled:!1,selectNextDisabled:!1}}})),ye=Object(i.b)(Oe,(function(e){return{selectPrev:function(){e(O.selectPrev())},selectNext:function(){e(O.selectNext())},swapWithPrev:function(){e(O.swapWithPrev())},swapWithNext:function(){e(O.swapWithNext())}}}))(ge),je=(n(65),function(e){var t=Object(me.a)().t;return c.a.createElement("div",{className:"editor-controls"},c.a.createElement(ye,null),c.a.createElement("div",{className:"control-buttons"},c.a.createElement("button",{disabled:e.undoDisabled,onClick:e.undo},t("undo")),c.a.createElement("button",{disabled:e.redoDisabled,onClick:e.redo},t("redo")),c.a.createElement("button",{disabled:e.freehandMode||0===e.glyph.length,onClick:e.selectAll},t("select all")),c.a.createElement("button",{disabled:e.freehandMode||0===e.glyph.length,onClick:e.selectDeselected},t("invert selection")),c.a.createElement("button",{disabled:0===e.selection.length,onClick:e.copy},t("copy")),c.a.createElement("button",{disabled:e.pasteDisabled,onClick:e.paste},t("paste")),c.a.createElement("button",{disabled:0===e.selection.length,onClick:e.cut},t("cut")),c.a.createElement("button",{disabled:!0,onClick:e.toggleFreehand},e.freehandMode?t("end freehand"):t("start freehand")),c.a.createElement("button",{disabled:e.decomposeDisabled,onClick:e.decompose},t("decompose")),c.a.createElement("button",{disabled:!0,onClick:e.options},t("options"))),c.a.createElement("div",{className:"preview"},c.a.createElement("svg",{className:"preview-thumbnail",viewBox:"0 0 200 200",width:"50",height:"50"}),c.a.createElement("button",{disabled:!0,onClick:e.finishEdit},t("finish edit"))))}),Ee=Object(ie.a)([function(e){return e.editor.glyph},function(e){return e.editor.buhinMap},function(e){return e.editor.selection},function(e){return e.editor.clipboard},function(e){return e.editor.freehandMode}],(function(e,t,n,a,r){return{glyph:e,buhinMap:t,selection:n,undoDisabled:!0,redoDisabled:!0,pasteDisabled:0===a.length,decomposeDisabled:!n.some((function(t){return 99===e[t].value[0]})),freehandMode:r}})),Me=Object(i.b)(Ee,(function(e){return{undo:function(){e(O.undo())},redo:function(){e(O.redo())},selectAll:function(){e(O.selectAll())},selectDeselected:function(){e(O.selectDeselected())},copy:function(){e(O.copy())},paste:function(){e(O.paste())},cut:function(){e(O.cut())},toggleFreehand:function(){e(O.toggleFreehand())},decompose:function(){e(O.decomposeSelected())},options:function(){e(O.openOptionModal())},finishEdit:function(){}}}))(je);var we=function(){return c.a.createElement("div",{className:"App"},c.a.createElement(be,null),c.a.createElement(Me,null),c.a.createElement("div",{className:"parts-list-area"}))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var xe=n(21),Se=n(14),De={ja:{translation:n(33)}},Ne=q.get("host"),ke="ja";if(Ne)switch(Ne.split(".")[0]){case"en":ke="en";break;case"ko":ke="ko";break;case"zhs":ke="zh-Hans";break;case"zht":ke="zh-Hant"}xe.a.use(Se.e).init({resources:De,lng:ke,returnObjects:!0,interpolation:{escapeValue:!1}});xe.a,n(66);l.a.render(c.a.createElement(c.a.StrictMode,null,c.a.createElement(i.a,{store:re},c.a.createElement(we,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[34,1,2]]]);
//# sourceMappingURL=main.9404dcb9.chunk.js.map