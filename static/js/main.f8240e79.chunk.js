(this["webpackJsonpkage-editor"]=this["webpackJsonpkage-editor"]||[]).push([[0],{24:function(e){e.exports=JSON.parse("{}")},28:function(e,t,n){e.exports=n(53)},46:function(e,t,n){},47:function(e,t,n){},48:function(e,t,n){},49:function(e,t,n){},50:function(e,t,n){},51:function(e,t,n){},52:function(e,t,n){},53:function(e,t,n){"use strict";n.r(t);var a,c=n(0),r=n.n(c),o=n(8),l=n.n(o),s=n(5),i=n(4),u=n(3),h=n(1),m=n(2),d=n(20),f=n(11),v=n(21),g=n.n(v);!function(e){e[e.north=0]="north",e[e.south=1]="south",e[e.east=2]="east",e[e.west=3]="west",e[e.southeast=4]="southeast"}(a||(a={}));var b,p=g()("EDITOR"),O={selectSingle:p("SELECT_SINGLE"),selectAddSingle:p("SELECT_ADD_SINGLE"),selectRemoveSingle:p("SELECT_REMOVE_SINGLE"),selectNone:p("SELECT_NONE"),selectAll:p("SELECT_ALL"),selectPrev:p("SELECT_PREV"),selectNext:p("SELECT_NEXT"),startAreaSelect:p("AREA_SELECT_START"),startSelectionDrag:p("SELECTION_DRAG_START"),startPointDrag:p("MOVE_POINT_START"),startResize:p("RESIZE_START"),mouseMove:p("MOUSE_MOVE"),mouseUp:p("MOUSE_UP"),updateCTMInv:p("UPDATE_CTMINV")},j=n(10),S=function(e){var t=e.value.slice();return 99===t[0]&&(t[7]=e.partName||""),t.join(":")},E=function(e){var t=e.map((function(e){return Object(m.a)(e,1)[0]})),n=e.map((function(e){return Object(m.a)(e,2)[1]}));return[Math.min.apply(Math,Object(u.a)(t)),Math.min.apply(Math,Object(u.a)(n)),Math.max.apply(Math,Object(u.a)(t)),Math.max.apply(Math,Object(u.a)(n))]},M=function(e){switch(e.value[0]){case 99:return E([[e.value[3],e.value[4]],[e.value[5],e.value[6]]]);case 0:case 1:case 2:case 3:case 4:case 6:case 7:case 9:for(var t=[],n=3;n+2<=e.value.length;n+=2)t.push([e.value[n],e.value[n+1]]);return E(t);default:return E([])}},y=function(e,t){var n=Object(m.a)(e,4),a=n[0],c=n[1],r=n[2],o=n[3],l=Object(m.a)(t,4),s=l[0],i=l[1],u=l[2],h=l[3];return[Math.min(a,s),Math.min(c,i),Math.max(r,u),Math.max(o,h)]},w=Object(j.a)((function(e){return e.map(M).reduce(y,E([]))}),(function(e,t){return e.length===t.length&&e.every((function(e,n){return e===t[n]}))})),C=function(e,t,n,a){return e},D=function(e,t,n,a,c){return e},N=function(e,t,n,a){return e.map((function(e,c){return t.includes(c)?function(e,t,n){var a=Object(m.a)(t,4),c=a[0],r=a[1],o=a[2],l=a[3],s=Object(m.a)(n,4),i=s[0],u=s[1],h=s[2],d=s[3],f=function(e){return i+(e-c)*(h-i)/(o-c)},v=function(e){return u+(e-r)*(d-u)/(l-r)};switch(e.value[0]){case 99:var g=e.value.slice();return g[3]=f(g[3]),g[4]=v(g[4]),g[5]=f(g[5]),g[6]=v(g[6]),{value:g,partName:e.partName};case 0:case 1:case 2:case 3:case 4:case 6:case 7:case 9:for(var b=e.value.slice(),p=3;p+2<=b.length;p+=2)b[p]=f(b[p]),b[p+1]=v(b[p+1]);return{value:b};default:return e}}(e,n,a):e}))},x=new(n(22).Kage),I=Object(j.a)((function(e){var t=e.map(S);return x.makeGlyphSeparated(t)})),k=new URLSearchParams(window.location.hash.slice(1)),R=function(e,t,n,c,r){var o=w(t.map((function(t){return e[t]}))),l=o.slice();switch(n){case a.north:l[1]=Math.min(l[1]+r,l[3]-20);break;case a.west:l[0]=Math.min(l[0]+c,l[2]-20);break;case a.south:l[3]=Math.max(l[3]+r,l[1]+20);break;case a.east:l[2]=Math.max(l[2]+c,l[0]+20);break;case a.southeast:l[2]=Math.max(l[2]+c,l[0]+20),l[3]=Math.max(l[3]+r,l[1]+20)}return N(e,t,o,l)},P=function(e){var t=e.glyph;if(e.dragSelection){var n=Object(m.a)(e.dragSelection,4),a=n[0],c=n[1];n[2],n[3];t=C(e.glyph,e.selection)}else if(e.dragPoint){var r=Object(m.a)(e.dragPoint,2),o=(r[0],Object(m.a)(r[1],4)),l=o[0],s=o[1];o[2],o[3];t=D(e.glyph,e.selection)}else if(e.resizeSelection){var i=Object(m.a)(e.resizeSelection,2),u=i[0],h=Object(m.a)(i[1],4),d=h[0],f=h[1],v=h[2]-d,g=h[3]-f;t=R(e.glyph,e.selection,u,v,g)}return t},T={glyph:(b=k.get("data")||"",b.split(/[$\r\n]+/).map((function(e){return function(e){for(var t=e.split(":"),n=function(e){switch(e){case 0:case 1:case 9:return 7;case 2:return 9;case 3:case 4:case 6:case 99:return 11;default:return 0}}(+t[0]),a=[],c=0;c<n;c++)a.push(Math.floor(+t[c]||0));return 99===a[0]?{value:a,partName:t[7]||""}:{value:a}}(e)})).filter((function(e){return 0!==(t=e).value.length&&(0!==t.value[0]||97===t.value[1]||98===t.value[1]||99===t.value[1]);var t}))),selection:[],areaSelectRect:null,dragSelection:null,dragPoint:null,resizeSelection:null,ctmInv:null},A=Object(d.reducerWithInitialState)(T).case(O.selectSingle,(function(e,t){return Object(h.a)(Object(h.a)({},e),{},{selection:[t]})})).case(O.selectAddSingle,(function(e,t){return Object(h.a)(Object(h.a)({},e),{},{selection:e.selection.includes(t)?e.selection:e.selection.concat([t])})})).case(O.selectRemoveSingle,(function(e,t){return Object(h.a)(Object(h.a)({},e),{},{selection:e.selection.filter((function(e){return t!==e}))})})).case(O.selectAll,(function(e){return Object(h.a)(Object(h.a)({},e),{},{selection:e.glyph.map((function(e,t){return t}))})})).case(O.selectNone,(function(e){return Object(h.a)(Object(h.a)({},e),{},{selection:[]})})).case(O.selectPrev,(function(e){if(0===e.glyph.length)return Object(h.a)(Object(h.a)({},e),{},{selection:[]});var t=0===e.selection.length?0:Math.min.apply(Math,Object(u.a)(e.selection));return Object(h.a)(Object(h.a)({},e),{},{selection:[(t-1+e.glyph.length)%e.glyph.length]})})).case(O.selectNext,(function(e){if(0===e.glyph.length)return Object(h.a)(Object(h.a)({},e),{},{selection:[]});var t=0===e.selection.length?-1:Math.max.apply(Math,Object(u.a)(e.selection));return Object(h.a)(Object(h.a)({},e),{},{selection:[(t+1+e.glyph.length)%e.glyph.length]})})).case(O.startAreaSelect,(function(e,t){if(!e.ctmInv)return e;var n=e.ctmInv(t.clientX,t.clientY),a=Object(m.a)(n,2),c=a[0],r=a[1];return Object(h.a)(Object(h.a)({},e),{},{areaSelectRect:[c,r,c,r]})})).case(O.startSelectionDrag,(function(e,t){if(!e.ctmInv)return e;var n=e.ctmInv(t.clientX,t.clientY),a=Object(m.a)(n,2),c=a[0],r=a[1];return Object(h.a)(Object(h.a)({},e),{},{dragSelection:[c,r,c,r]})})).case(O.startPointDrag,(function(e,t){var n=Object(m.a)(t,2),a=n[0],c=n[1];if(!e.ctmInv)return e;var r=e.ctmInv(a.clientX,a.clientY),o=Object(m.a)(r,2),l=o[0],s=o[1];return Object(h.a)(Object(h.a)({},e),{},{dragPoint:[c,[l,s,l,s]]})})).case(O.startResize,(function(e,t){var n=Object(m.a)(t,2),a=n[0],c=n[1];if(!e.ctmInv)return e;var r=e.ctmInv(a.clientX,a.clientY),o=Object(m.a)(r,2),l=o[0],s=o[1];return Object(h.a)(Object(h.a)({},e),{},{resizeSelection:[c,[l,s,l,s]]})})).case(O.mouseMove,(function(e,t){if(!e.ctmInv)return e;if(e.areaSelectRect){var n=Object(m.a)(e.areaSelectRect,2),a=n[0],c=n[1],r=e.ctmInv(t.clientX,t.clientY),o=Object(m.a)(r,2),l=o[0],s=o[1];return Object(h.a)(Object(h.a)({},e),{},{areaSelectRect:[a,c,l,s]})}if(e.dragSelection){var i=Object(m.a)(e.dragSelection,2),u=i[0],d=i[1],f=e.ctmInv(t.clientX,t.clientY),v=Object(m.a)(f,2),g=v[0],b=v[1];return Object(h.a)(Object(h.a)({},e),{},{dragSelection:[u,d,g,b]})}if(e.dragPoint){var p=Object(m.a)(e.dragPoint,2),O=p[0],j=Object(m.a)(p[1],2),S=j[0],E=j[1],M=e.ctmInv(t.clientX,t.clientY),y=Object(m.a)(M,2),w=y[0],C=y[1];return Object(h.a)(Object(h.a)({},e),{},{dragPoint:[O,[S,E,w,C]]})}if(e.resizeSelection){var D=Object(m.a)(e.resizeSelection,2),N=D[0],x=Object(m.a)(D[1],2),I=x[0],k=x[1],R=e.ctmInv(t.clientX,t.clientY),P=Object(m.a)(R,2),T=P[0],A=P[1];return Object(h.a)(Object(h.a)({},e),{},{resizeSelection:[N,[I,k,T,A]]})}return e})).case(O.mouseUp,(function(e,t){if(!e.ctmInv)return e;if(e.areaSelectRect){var n=Object(m.a)(e.areaSelectRect,2),a=n[0],c=n[1],r=e.ctmInv(t.clientX,t.clientY),o=Object(m.a)(r,2),l=o[0],s=o[1],i=function(e,t,n,a,c){for(var r=I(e),o=[],l=[[t,n],[t,c],[a,c],[a,n],[t,n]],s=0;s<r.length;s++){r[s].array.some((function(e){var t=e.array.map((function(e){return[e.x,e.y]}));return t.push(t[0]),Object(f.a)(l,t)||Object(f.a)(t,l)||Object(f.b)(l,t)}))&&o.push(s)}return o}(e.glyph,a,c,l,s),u=Array.from(new Set(e.selection.concat(i)));return Object(h.a)(Object(h.a)({},e),{},{selection:u,areaSelectRect:null})}if(e.dragSelection){var d=Object(m.a)(e.dragSelection,2),v=(d[0],d[1],e.ctmInv(t.clientX,t.clientY)),g=Object(m.a)(v,2),b=(g[0],g[1],C(e.glyph,e.selection));return Object(h.a)(Object(h.a)({},e),{},{glyph:b,dragSelection:null})}if(e.dragPoint){var p=Object(m.a)(e.dragPoint,2),O=(p[0],Object(m.a)(p[1],2)),j=(O[0],O[1],e.ctmInv(t.clientX,t.clientY)),S=Object(m.a)(j,2),E=(S[0],S[1],D(e.glyph,e.selection));return Object(h.a)(Object(h.a)({},e),{},{glyph:E,dragPoint:null})}if(e.resizeSelection){var M=Object(m.a)(e.resizeSelection,2),y=M[0],w=Object(m.a)(M[1],2),N=w[0],x=w[1],k=e.ctmInv(t.clientX,t.clientY),P=Object(m.a)(k,2),T=P[0],A=P[1],L=R(e.glyph,e.selection,y,T-N,A-x);return Object(h.a)(Object(h.a)({},e),{},{glyph:L,resizeSelection:null})}return e})).case(O.updateCTMInv,(function(e,t){return Object(h.a)(Object(h.a)({},e),{},{ctmInv:t})})),L=Object(i.b)({editor:A}),_=(n(46),n(47),function(e){return r.a.createElement(r.a.Fragment,null,e.polygons.array.map((function(e,t){return r.a.createElement("polygon",{key:t,points:e.array.map((function(e){var t=e.x,n=e.y;return"".concat(t,",").concat(n," ")})).join("")})})))}),z=(n(48),function(e){var t=I(e.glyph),n=e.selection,a=t.map((function(e,t){return t})).filter((function(e){return!n.includes(e)}));return r.a.createElement(r.a.Fragment,null,r.a.createElement("g",{className:"strokes-deselected"},a.map((function(n){return r.a.createElement("g",{key:n,onMouseDown:function(t){var a;return null===(a=e.handleMouseDownDeselectedStroke)||void 0===a?void 0:a.call(e,t,n)}},r.a.createElement(_,{polygons:t[n]}))}))),r.a.createElement("g",{className:"strokes-selected"},n.map((function(n){return r.a.createElement("g",{key:n,onMouseDown:function(t){var a;return null===(a=e.handleMouseDownSelectedStroke)||void 0===a?void 0:a.call(e,t,n)}},r.a.createElement(_,{polygons:t[n]}))}))))}),X=(n(49),function(e){if(!e.rect)return null;var t=Object(m.a)(e.rect,4),n=t[0],a=t[1],c=t[2],o=t[3];if(n>c){var l=n;n=c,c=l}if(a>o){var s=a;a=o,o=s}return r.a.createElement("rect",{className:"areaselect-rect",x:n,y:a,width:c-n,height:o-a})}),Y=n(23),U=(n(50),function(e){return r.a.createElement("rect",{x:e.x-4,y:e.y-4,width:8,height:8,className:"controlpoint-rect ".concat(e.className||""),onMouseDown:e.handleMouseDown})}),V=(n(51),function(e){return r.a.createElement(r.a.Fragment,null,e.rectControl&&r.a.createElement(r.a.Fragment,null,r.a.createElement("rect",{className:"selection-rect",x:e.rectControl.coords[0],y:e.rectControl.coords[1],width:e.rectControl.coords[2]-e.rectControl.coords[0],height:e.rectControl.coords[3]-e.rectControl.coords[1]}),r.a.createElement(U,{x:(e.rectControl.coords[0]+e.rectControl.coords[2])/2,y:e.rectControl.coords[1],className:"north",handleMouseDown:function(t){return e.handleMouseDownRectControl(t,a.north)}}),r.a.createElement(U,{x:e.rectControl.coords[0],y:(e.rectControl.coords[1]+e.rectControl.coords[3])/2,className:"west",handleMouseDown:function(t){return e.handleMouseDownRectControl(t,a.west)}}),r.a.createElement(U,{x:(e.rectControl.coords[0]+e.rectControl.coords[2])/2,y:e.rectControl.coords[3],className:"south",handleMouseDown:function(t){return e.handleMouseDownRectControl(t,a.south)}}),r.a.createElement(U,{x:e.rectControl.coords[2],y:(e.rectControl.coords[1]+e.rectControl.coords[3])/2,className:"east",handleMouseDown:function(t){return e.handleMouseDownRectControl(t,a.east)}}),r.a.createElement(U,{x:e.rectControl.coords[2],y:e.rectControl.coords[3],className:"southeast",handleMouseDown:function(t){return e.handleMouseDownRectControl(t,a.southeast)}})),e.pointControl.map((function(t,n){var a=t.x,c=t.y,o=t.className;return r.a.createElement(U,{key:n,x:a,y:c,className:o,handleMouseDown:function(t){return e.handleMouseDownPointControl(t,n)}})})))}),G=Object(Y.a)([function(e){return P(e.editor)},function(e){return e.editor.selection}],(function(e,t){if(0===t.length)return{rectControl:null,pointControl:[]};if(t.length>1){var n=t.map((function(t){return e[t]}));return{rectControl:{multiSelect:!0,coords:w(n)},pointControl:[]}}var a=e[t[0]];switch(a.value[0]){case 0:case 9:case 99:return{rectControl:{multiSelect:!1,coords:[a.value[3],a.value[4],a.value[5],a.value[6]]},pointControl:[]};case 1:case 2:case 3:case 4:case 6:case 7:for(var c=[],r=3;r+2<=a.value.length;r+=2)c.push({x:a.value[r],y:a.value[r+1],className:""});return{rectControl:null,pointControl:c};default:return{rectControl:null,pointControl:[]}}})),K=Object(s.b)(G,(function(e){return{handleMouseDownRectControl:function(t,n){e(O.startResize([t,n])),t.stopPropagation()},handleMouseDownPointControl:function(t,n){e(O.startPointDrag([t,n])),t.stopPropagation()}}}))(V),B=(n(52),function(e){var t=e.handleMouseMove,n=e.handleMouseUp;return Object(c.useEffect)((function(){return document.addEventListener("mousemove",t),document.addEventListener("mouseup",n),function(){document.removeEventListener("mousemove",t),document.removeEventListener("mouseup",n)}}),[t,n]),r.a.createElement("div",{className:"glyph-area"},r.a.createElement("svg",{width:"100%",height:"100%",viewBox:"-20 -20 500 240",onMouseDownCapture:e.handleMouseDownCapture,onMouseDown:e.handleMouseDownBackground},r.a.createElement("rect",{x:"0",y:"0",width:"200",height:"200",className:"glyph-boundary"}),r.a.createElement("rect",{x:"12",y:"12",width:"176",height:"176",className:"glyph-guide"}),r.a.createElement(z,{glyph:e.glyph,selection:e.selection,handleMouseDownDeselectedStroke:e.handleMouseDownDeselectedStroke,handleMouseDownSelectedStroke:e.handleMouseDownSelectedStroke}),r.a.createElement(K,null),r.a.createElement(X,{rect:e.areaSelectRect})))}),F=Object(s.b)((function(e){return Object(h.a)(Object(h.a)({},e.editor),{},{glyph:P(e.editor)})}),(function(e){return{handleMouseDownCapture:function(t){if(t.target instanceof SVGSVGElement){var n=t.target.getScreenCTM();if(n){var a=t.target.createSVGPoint();e(O.updateCTMInv((function(e,t){a.x=e,a.y=t;var c=a.matrixTransform(n.inverse());return[c.x,c.y]})))}}},handleMouseDownBackground:function(t){t.shiftKey||t.ctrlKey||e(O.selectNone()),e(O.startAreaSelect(t))},handleMouseDownDeselectedStroke:function(t,n){t.shiftKey||t.ctrlKey?e(O.selectAddSingle(n)):e(O.selectSingle(n)),e(O.startSelectionDrag(t)),t.stopPropagation()},handleMouseDownSelectedStroke:function(t,n){(t.shiftKey||t.ctrlKey)&&e(O.selectRemoveSingle(n)),e(O.startSelectionDrag(t)),t.stopPropagation()},handleMouseMove:function(t){e(O.mouseMove(t))},handleMouseUp:function(t){e(O.mouseUp(t))}}}))(B);var J=function(){return r.a.createElement("div",{className:"App"},r.a.createElement(F,null),r.a.createElement("div",{className:"editor-controls"}),r.a.createElement("div",{className:"parts-list-area"}))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var W=n(15),H=n(55),$={ja:{translation:n(24)}},Z=k.get("host"),q="ja";if(Z)switch(Z.split(".")[0]){case"en":q="en";break;case"ko":q="ko";break;case"zhs":q="zh-Hans";break;case"zht":q="zh-Hant"}W.a.use(H.a).init({resources:$,lng:q,returnObjects:!0,interpolation:{escapeValue:!1}});W.a;var Q=Object(i.c)(L);l.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(s.a,{store:Q},r.a.createElement(J,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[28,1,2]]]);
//# sourceMappingURL=main.f8240e79.chunk.js.map